function cov_2cj0y606k(){var path="/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-client-logic/authenticate-user.spec.js";var hash="8dc218a010d6f4729d3079367745ef9e274500a0";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-client-logic/authenticate-user.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:60},end:{line:3,column:67}},"2":{start:{line:5,column:25},end:{line:5,column:55}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:19},end:{line:7,column:34}},"5":{start:{line:8,column:39},end:{line:8,column:63}},"6":{start:{line:9,column:15},end:{line:9,column:34}},"7":{start:{line:11,column:0},end:{line:11,column:36}},"8":{start:{line:12,column:24},end:{line:12,column:52}},"9":{start:{line:13,column:14},end:{line:13,column:26}},"10":{start:{line:14,column:13},end:{line:14,column:28}},"11":{start:{line:16,column:0},end:{line:16,column:35}},"12":{start:{line:17,column:0},end:{line:17,column:43}},"13":{start:{line:19,column:0},end:{line:82,column:2}},"14":{start:{line:20,column:4},end:{line:20,column:47}},"15":{start:{line:20,column:17},end:{line:20,column:46}},"16":{start:{line:24,column:4},end:{line:35,column:5}},"17":{start:{line:25,column:8},end:{line:34,column:40}},"18":{start:{line:27,column:16},end:{line:27,column:41}},"19":{start:{line:28,column:16},end:{line:28,column:47}},"20":{start:{line:29,column:16},end:{line:29,column:48}},"21":{start:{line:30,column:16},end:{line:30,column:49}},"22":{start:{line:32,column:16},end:{line:32,column:48}},"23":{start:{line:34,column:27},end:{line:34,column:39}},"24":{start:{line:37,column:4},end:{line:68,column:6}},"25":{start:{line:38,column:8},end:{line:41,column:9}},"26":{start:{line:39,column:12},end:{line:40,column:47}},"27":{start:{line:40,column:30},end:{line:40,column:46}},"28":{start:{line:43,column:8},end:{line:56,column:9}},"29":{start:{line:44,column:12},end:{line:55,column:18}},"30":{start:{line:46,column:19},end:{line:54,column:21}},"31":{start:{line:48,column:23},end:{line:48,column:31}},"32":{start:{line:49,column:43},end:{line:49,column:59}},"33":{start:{line:50,column:37},end:{line:50,column:62}},"34":{start:{line:52,column:23},end:{line:52,column:51}},"35":{start:{line:58,column:8},end:{line:67,column:10}},"36":{start:{line:59,column:12},end:{line:59,column:32}},"37":{start:{line:61,column:12},end:{line:66,column:18}},"38":{start:{line:62,column:30},end:{line:62,column:76}},"39":{start:{line:64,column:20},end:{line:64,column:60}},"40":{start:{line:65,column:20},end:{line:65,column:68}},"41":{start:{line:70,column:4},end:{line:77,column:5}},"42":{start:{line:71,column:8},end:{line:76,column:14}},"43":{start:{line:72,column:26},end:{line:72,column:72}},"44":{start:{line:74,column:16},end:{line:74,column:56}},"45":{start:{line:75,column:16},end:{line:75,column:90}},"46":{start:{line:79,column:4},end:{line:79,column:38}},"47":{start:{line:79,column:20},end:{line:79,column:37}},"48":{start:{line:81,column:4},end:{line:81,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:19,column:38},end:{line:19,column:39}},loc:{start:{line:19,column:44},end:{line:82,column:1}},line:19},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:11},end:{line:20,column:12}},loc:{start:{line:20,column:17},end:{line:20,column:46}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:24,column:15},end:{line:24,column:16}},loc:{start:{line:25,column:8},end:{line:34,column:40}},line:25},"3":{name:"(anonymous_3)",decl:{start:{line:26,column:18},end:{line:26,column:19}},loc:{start:{line:26,column:24},end:{line:33,column:13}},line:26},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:18},end:{line:34,column:19}},loc:{start:{line:34,column:27},end:{line:34,column:39}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:37,column:41},end:{line:37,column:42}},loc:{start:{line:37,column:47},end:{line:68,column:5}},line:37},"6":{name:"(anonymous_6)",decl:{start:{line:38,column:19},end:{line:38,column:20}},loc:{start:{line:39,column:12},end:{line:40,column:47}},line:39},"7":{name:"(anonymous_7)",decl:{start:{line:40,column:22},end:{line:40,column:23}},loc:{start:{line:40,column:30},end:{line:40,column:46}},line:40},"8":{name:"(anonymous_8)",decl:{start:{line:43,column:52},end:{line:43,column:53}},loc:{start:{line:44,column:12},end:{line:55,column:18}},line:44},"9":{name:"(anonymous_9)",decl:{start:{line:45,column:22},end:{line:45,column:23}},loc:{start:{line:45,column:28},end:{line:55,column:17}},line:45},"10":{name:"(anonymous_10)",decl:{start:{line:47,column:25},end:{line:47,column:26}},loc:{start:{line:47,column:32},end:{line:54,column:20}},line:47},"11":{name:"(anonymous_11)",decl:{start:{line:58,column:44},end:{line:58,column:45}},loc:{start:{line:58,column:50},end:{line:67,column:9}},line:58},"12":{name:"(anonymous_12)",decl:{start:{line:62,column:22},end:{line:62,column:23}},loc:{start:{line:62,column:28},end:{line:62,column:78}},line:62},"13":{name:"(anonymous_13)",decl:{start:{line:63,column:23},end:{line:63,column:24}},loc:{start:{line:63,column:32},end:{line:66,column:17}},line:63},"14":{name:"(anonymous_14)",decl:{start:{line:70,column:47},end:{line:70,column:48}},loc:{start:{line:71,column:8},end:{line:76,column:14}},line:71},"15":{name:"(anonymous_15)",decl:{start:{line:72,column:18},end:{line:72,column:19}},loc:{start:{line:72,column:24},end:{line:72,column:74}},line:72},"16":{name:"(anonymous_16)",decl:{start:{line:73,column:19},end:{line:73,column:20}},loc:{start:{line:73,column:28},end:{line:76,column:13}},line:73},"17":{name:"(anonymous_17)",decl:{start:{line:79,column:14},end:{line:79,column:15}},loc:{start:{line:79,column:20},end:{line:79,column:37}},line:79}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"8dc218a010d6f4729d3079367745ef9e274500a0"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2cj0y606k=function(){return actualCoverage;};}return actualCoverage;}cov_2cj0y606k();cov_2cj0y606k().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL,API_URL}}=(cov_2cj0y606k().s[1]++,process);const authenticateUser=(cov_2cj0y606k().s[2]++,require('./authenticate-user'));const{random}=(cov_2cj0y606k().s[3]++,Math);const{expect}=(cov_2cj0y606k().s[4]++,require('chai'));const{mongoose,models:{User}}=(cov_2cj0y606k().s[5]++,require('coohappy-data'));const bcrypt=(cov_2cj0y606k().s[6]++,require('bcryptjs'));cov_2cj0y606k().s[7]++;global.fetch=require('node-fetch');const notAsyncStorage=(cov_2cj0y606k().s[8]++,require('not-async-storage'));const logic=(cov_2cj0y606k().s[9]++,require('.'));const atob=(cov_2cj0y606k().s[10]++,require('atob'));cov_2cj0y606k().s[11]++;logic.__context__.API_URL=API_URL;cov_2cj0y606k().s[12]++;logic.__context__.storage=notAsyncStorage;cov_2cj0y606k().s[13]++;describe('logic - authenticate user',()=>{cov_2cj0y606k().f[0]++;cov_2cj0y606k().s[14]++;before(()=>{cov_2cj0y606k().f[1]++;cov_2cj0y606k().s[15]++;return mongoose.connect(MONGODB_URL);});let name,surname,email,password,userId,hash;cov_2cj0y606k().s[16]++;beforeEach(()=>{cov_2cj0y606k().f[2]++;cov_2cj0y606k().s[17]++;return User.deleteMany().then(()=>{cov_2cj0y606k().f[3]++;cov_2cj0y606k().s[18]++;name=`name-${random()}`;cov_2cj0y606k().s[19]++;surname=`surname-${random()}`;cov_2cj0y606k().s[20]++;email=`e-${random()}@mail.com`;cov_2cj0y606k().s[21]++;password=`password-${random()}`;cov_2cj0y606k().s[22]++;return bcrypt.hash(password,10);}).then(_hash=>{cov_2cj0y606k().f[4]++;cov_2cj0y606k().s[23]++;return hash=_hash;});});cov_2cj0y606k().s[24]++;describe('when user already exists',()=>{cov_2cj0y606k().f[5]++;cov_2cj0y606k().s[25]++;beforeEach(()=>{cov_2cj0y606k().f[6]++;cov_2cj0y606k().s[26]++;return User.create({name,surname,email,password:hash}).then(user=>{cov_2cj0y606k().f[7]++;cov_2cj0y606k().s[27]++;return userId=user.id;});});cov_2cj0y606k().s[28]++;it('should succeed on correct credentials',()=>{cov_2cj0y606k().f[8]++;cov_2cj0y606k().s[29]++;return authenticateUser(email,password).then(()=>{cov_2cj0y606k().f[9]++;cov_2cj0y606k().s[30]++;return logic.__context__.storage.getItem('TOKEN').then(token=>{cov_2cj0y606k().f[10]++;cov_2cj0y606k().s[31]++;debugger;const[,payload]=(cov_2cj0y606k().s[32]++,token.split('.'));const{sub}=(cov_2cj0y606k().s[33]++,JSON.parse(atob(payload)));cov_2cj0y606k().s[34]++;expect(sub).to.equal(userId);});});});cov_2cj0y606k().s[35]++;it('should fail on wrong password',()=>{cov_2cj0y606k().f[11]++;cov_2cj0y606k().s[36]++;password+='wrong-';cov_2cj0y606k().s[37]++;return authenticateUser(email,password).then(()=>{cov_2cj0y606k().f[12]++;cov_2cj0y606k().s[38]++;throw new Error('should not reach this point');}).catch(error=>{cov_2cj0y606k().f[13]++;cov_2cj0y606k().s[39]++;expect(error).to.be.an.instanceof(Error);cov_2cj0y606k().s[40]++;expect(error.message).to.equal(`Wrong password`);});});});cov_2cj0y606k().s[41]++;it('should fail when user does not exist',()=>{cov_2cj0y606k().f[14]++;cov_2cj0y606k().s[42]++;return authenticateUser(email,password).then(()=>{cov_2cj0y606k().f[15]++;cov_2cj0y606k().s[43]++;throw new Error('should not reach this point');}).catch(error=>{cov_2cj0y606k().f[16]++;cov_2cj0y606k().s[44]++;expect(error).to.be.an.instanceof(Error);cov_2cj0y606k().s[45]++;expect(error.message).to.equal(`User with e-mail ${email} does not exist`);});});cov_2cj0y606k().s[46]++;afterEach(()=>{cov_2cj0y606k().f[17]++;cov_2cj0y606k().s[47]++;return User.deleteMany();});cov_2cj0y606k().s[48]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0ZS11c2VyLnNwZWMuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImNvbmZpZyIsImVudiIsIlRFU1RfTU9OR09EQl9VUkwiLCJNT05HT0RCX1VSTCIsIkFQSV9VUkwiLCJwcm9jZXNzIiwiYXV0aGVudGljYXRlVXNlciIsInJhbmRvbSIsIk1hdGgiLCJleHBlY3QiLCJtb25nb29zZSIsIm1vZGVscyIsIlVzZXIiLCJiY3J5cHQiLCJnbG9iYWwiLCJmZXRjaCIsIm5vdEFzeW5jU3RvcmFnZSIsImxvZ2ljIiwiYXRvYiIsIl9fY29udGV4dF9fIiwic3RvcmFnZSIsImRlc2NyaWJlIiwiYmVmb3JlIiwiY29ubmVjdCIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwYXNzd29yZCIsInVzZXJJZCIsImhhc2giLCJiZWZvcmVFYWNoIiwiZGVsZXRlTWFueSIsInRoZW4iLCJfaGFzaCIsImNyZWF0ZSIsInVzZXIiLCJpZCIsIml0IiwiZ2V0SXRlbSIsInRva2VuIiwicGF5bG9hZCIsInNwbGl0Iiwic3ViIiwiSlNPTiIsInBhcnNlIiwidG8iLCJlcXVhbCIsIkVycm9yIiwiY2F0Y2giLCJlcnJvciIsImJlIiwiYW4iLCJpbnN0YW5jZW9mIiwibWVzc2FnZSIsImFmdGVyRWFjaCIsImFmdGVyIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6Ims5TUFlWTtnSEFmWkEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkMsTUFBbEIsR0FFQSxLQUFNLENBQUVDLEdBQUcsQ0FBRSxDQUFFQyxnQkFBZ0IsQ0FBRUMsV0FBcEIsQ0FBaUNDLE9BQWpDLENBQVAsMEJBQXNEQyxPQUF0RCxDQUFOLENBRUEsS0FBTUMsQ0FBQUEsZ0JBQWdCLHlCQUFHUCxPQUFPLENBQUMscUJBQUQsQ0FBVixDQUF0QixDQUNBLEtBQU0sQ0FBRVEsTUFBRiwwQkFBYUMsSUFBYixDQUFOLENBQ0EsS0FBTSxDQUFFQyxNQUFGLDBCQUFhVixPQUFPLENBQUMsTUFBRCxDQUFwQixDQUFO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QUYsQ0FuRHdDLHdCQTREeEM0QixTQUFTLENBQUMsSUFBTSx1REFBQTFDLENBQUFBLElBQUksQ0FBQ21CLFVBQUwsR0FBaUIsQ0FBeEIsQ0FBVCxDQTVEd0Msd0JBOER4Q3dCLEtBQUssQ0FBQzdDLFFBQVEsQ0FBQzhDLFVBQVYsQ0FBTCxDQUNILENBL0RPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKVxuXG5jb25zdCB7IGVudjogeyBURVNUX01PTkdPREJfVVJMOiBNT05HT0RCX1VSTCwgQVBJX1VSTCB9IH0gPSBwcm9jZXNzXG5cbmNvbnN0IGF1dGhlbnRpY2F0ZVVzZXIgPSByZXF1aXJlKCcuL2F1dGhlbnRpY2F0ZS11c2VyJylcbmNvbnN0IHsgcmFuZG9tIH0gPSBNYXRoXG5jb25zdCB7IGV4cGVjdCB9ID0gcmVxdWlyZSgnY2hhaScpXG5jb25zdCB7IG1vbmdvb3NlLCBtb2RlbHM6IHsgVXNlciB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1kYXRhJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJylcblxuZ2xvYmFsLmZldGNoID0gcmVxdWlyZSgnbm9kZS1mZXRjaCcpXG5jb25zdCBub3RBc3luY1N0b3JhZ2UgPSByZXF1aXJlKCdub3QtYXN5bmMtc3RvcmFnZScpXG5jb25zdCBsb2dpYyA9IHJlcXVpcmUoJy4nKVxuY29uc3QgYXRvYiA9IHJlcXVpcmUoJ2F0b2InKVxuXG5sb2dpYy5fX2NvbnRleHRfXy5BUElfVVJMID0gQVBJX1VSTFxubG9naWMuX19jb250ZXh0X18uc3RvcmFnZSA9IG5vdEFzeW5jU3RvcmFnZVxuXG5kZXNjcmliZSgnbG9naWMgLSBhdXRoZW50aWNhdGUgdXNlcicsICgpID0+IHtcbiAgICBiZWZvcmUoKCkgPT4gbW9uZ29vc2UuY29ubmVjdChNT05HT0RCX1VSTCkpXG5cbiAgICBsZXQgbmFtZSwgc3VybmFtZSwgZW1haWwsIHBhc3N3b3JkLCB1c2VySWQsIGhhc2hcblxuICAgIGJlZm9yZUVhY2goKCkgPT5cbiAgICAgICAgVXNlci5kZWxldGVNYW55KClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICBuYW1lID0gYG5hbWUtJHtyYW5kb20oKX1gXG4gICAgICAgICAgICAgICAgc3VybmFtZSA9IGBzdXJuYW1lLSR7cmFuZG9tKCl9YFxuICAgICAgICAgICAgICAgIGVtYWlsID0gYGUtJHtyYW5kb20oKX1AbWFpbC5jb21gXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQgPSBgcGFzc3dvcmQtJHtyYW5kb20oKX1gXG5cbiAgICAgICAgICAgICAgICByZXR1cm4gYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC50aGVuKF9oYXNoID0+IGhhc2ggPSBfaGFzaClcbiAgICApXG5cbiAgICBkZXNjcmliZSgnd2hlbiB1c2VyIGFscmVhZHkgZXhpc3RzJywgKCkgPT4ge1xuICAgICAgICBiZWZvcmVFYWNoKCgpID0+XG4gICAgICAgICAgICBVc2VyLmNyZWF0ZSh7IG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZDogaGFzaCB9KVxuICAgICAgICAgICAgICAgIC50aGVuKHVzZXIgPT4gdXNlcklkID0gdXNlci5pZClcbiAgICAgICAgKVxuXG4gICAgICAgIGl0KCdzaG91bGQgc3VjY2VlZCBvbiBjb3JyZWN0IGNyZWRlbnRpYWxzJywgKCkgPT5cbiAgICAgICAgICAgIGF1dGhlbnRpY2F0ZVVzZXIoZW1haWwsIHBhc3N3b3JkKVxuICAgICAgICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICByZXR1cm4gbG9naWMuX19jb250ZXh0X18uc3RvcmFnZS5nZXRJdGVtKCdUT0tFTicpXG4gICAgICAgICAgICAgICAgICAgLnRoZW4odG9rZW49PntcbiAgICAgICAgICAgICAgICAgICAgICAgZGVidWdnZXJcbiAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgWywgcGF5bG9hZF0gPSB0b2tlbi5zcGxpdCgnLicpXG4gICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHtzdWJ9ID0gSlNPTi5wYXJzZShhdG9iKHBheWxvYWQpKVxuICAgXG4gICAgICAgICAgICAgICAgICAgICAgIGV4cGVjdChzdWIpLnRvLmVxdWFsKHVzZXJJZClcblxuICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgKVxuXG4gICAgICAgIGl0KCdzaG91bGQgZmFpbCBvbiB3cm9uZyBwYXNzd29yZCcsICgpID0+IHtcbiAgICAgICAgICAgIHBhc3N3b3JkICs9ICd3cm9uZy0nXG5cbiAgICAgICAgICAgIHJldHVybiBhdXRoZW50aWNhdGVVc2VyKGVtYWlsLCBwYXNzd29yZClcbiAgICAgICAgICAgICAgICAudGhlbigoKSA9PiB7IHRocm93IG5ldyBFcnJvcignc2hvdWxkIG5vdCByZWFjaCB0aGlzIHBvaW50JykgfSlcbiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvLmJlLmFuLmluc3RhbmNlb2YoRXJyb3IpXG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50by5lcXVhbChgV3JvbmcgcGFzc3dvcmRgKVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH0pXG4gICAgfSlcblxuICAgIGl0KCdzaG91bGQgZmFpbCB3aGVuIHVzZXIgZG9lcyBub3QgZXhpc3QnLCAoKSA9PlxuICAgICAgICBhdXRoZW50aWNhdGVVc2VyKGVtYWlsLCBwYXNzd29yZClcbiAgICAgICAgICAgIC50aGVuKCgpID0+IHsgdGhyb3cgbmV3IEVycm9yKCdzaG91bGQgbm90IHJlYWNoIHRoaXMgcG9pbnQnKSB9KVxuICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvLmJlLmFuLmluc3RhbmNlb2YoRXJyb3IpXG4gICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvLmVxdWFsKGBVc2VyIHdpdGggZS1tYWlsICR7ZW1haWx9IGRvZXMgbm90IGV4aXN0YClcbiAgICAgICAgICAgIH0pXG4gICAgKVxuXG4gICAgYWZ0ZXJFYWNoKCgpID0+IFVzZXIuZGVsZXRlTWFueSgpKVxuXG4gICAgYWZ0ZXIobW9uZ29vc2UuZGlzY29ubmVjdClcbn0pIl19