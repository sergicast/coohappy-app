function cov_qrf8q3iqt(){var path="/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/add-food.js";var hash="ab89720925b21ee9e964116c3e335a5d73f74c13";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/add-food.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:44}},"1":{start:{line:2,column:0},end:{line:2,column:42}},"2":{start:{line:3,column:41},end:{line:3,column:68}},"3":{start:{line:4,column:40},end:{line:4,column:64}},"4":{start:{line:5,column:35},end:{line:5,column:59}},"5":{start:{line:8,column:0},end:{line:51,column:1}},"6":{start:{line:10,column:4},end:{line:10,column:37}},"7":{start:{line:11,column:4},end:{line:11,column:35}},"8":{start:{line:13,column:4},end:{line:50,column:8}},"9":{start:{line:16,column:21},end:{line:16,column:48}},"10":{start:{line:17,column:8},end:{line:17,column:86}},"11":{start:{line:17,column:19},end:{line:17,column:86}},"12":{start:{line:19,column:26},end:{line:19,column:82}},"13":{start:{line:20,column:8},end:{line:20,column:108}},"14":{start:{line:20,column:24},end:{line:20,column:108}},"15":{start:{line:22,column:27},end:{line:22,column:59}},"16":{start:{line:22,column:36},end:{line:22,column:59}},"17":{start:{line:24,column:8},end:{line:33,column:9}},"18":{start:{line:24,column:47},end:{line:24,column:98}},"19":{start:{line:27,column:12},end:{line:32,column:13}},"20":{start:{line:29,column:16},end:{line:31,column:17}},"21":{start:{line:30,column:20},end:{line:30,column:83}},"22":{start:{line:35,column:8},end:{line:44,column:9}},"23":{start:{line:35,column:52},end:{line:35,column:108}},"24":{start:{line:38,column:12},end:{line:43,column:13}},"25":{start:{line:40,column:16},end:{line:42,column:17}},"26":{start:{line:41,column:20},end:{line:41,column:93}},"27":{start:{line:46,column:8},end:{line:46,column:25}},"28":{start:{line:47,column:8},end:{line:47,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:17},end:{line:8,column:18}},loc:{start:{line:8,column:39},end:{line:51,column:1}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:13,column:12},end:{line:13,column:13}},loc:{start:{line:13,column:24},end:{line:50,column:5}},line:13},"2":{name:"(anonymous_2)",decl:{start:{line:22,column:27},end:{line:22,column:28}},loc:{start:{line:22,column:36},end:{line:22,column:59}},line:22}},branchMap:{"0":{loc:{start:{line:17,column:8},end:{line:17,column:86}},type:"if",locations:[{start:{line:17,column:8},end:{line:17,column:86}},{start:{line:17,column:8},end:{line:17,column:86}}],line:17},"1":{loc:{start:{line:20,column:8},end:{line:20,column:108}},type:"if",locations:[{start:{line:20,column:8},end:{line:20,column:108}},{start:{line:20,column:8},end:{line:20,column:108}}],line:20},"2":{loc:{start:{line:24,column:8},end:{line:33,column:9}},type:"if",locations:[{start:{line:24,column:8},end:{line:33,column:9}},{start:{line:24,column:8},end:{line:33,column:9}}],line:24},"3":{loc:{start:{line:29,column:16},end:{line:31,column:17}},type:"if",locations:[{start:{line:29,column:16},end:{line:31,column:17}},{start:{line:29,column:16},end:{line:31,column:17}}],line:29},"4":{loc:{start:{line:35,column:8},end:{line:44,column:9}},type:"if",locations:[{start:{line:35,column:8},end:{line:44,column:9}},{start:{line:35,column:8},end:{line:44,column:9}}],line:35},"5":{loc:{start:{line:40,column:16},end:{line:42,column:17}},type:"if",locations:[{start:{line:40,column:16},end:{line:42,column:17}},{start:{line:40,column:16},end:{line:42,column:17}}],line:40}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ab89720925b21ee9e964116c3e335a5d73f74c13"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_qrf8q3iqt=function(){return actualCoverage;};}return actualCoverage;}cov_qrf8q3iqt();cov_qrf8q3iqt().s[0]++;require('coohappy-commons/polyfills/string');cov_qrf8q3iqt().s[1]++;require('coohappy-commons/polyfills/json');const{errors:{UnexistenceError}}=(cov_qrf8q3iqt().s[2]++,require('coohappy-commons'));const{models:{User,Cohousing}}=(cov_qrf8q3iqt().s[3]++,require('coohappy-data'));const{mongoose:{ObjectId}}=(cov_qrf8q3iqt().s[4]++,require('coohappy-data'));cov_qrf8q3iqt().s[5]++;module.exports=(foodItem,userId)=>{cov_qrf8q3iqt().f[0]++;cov_qrf8q3iqt().s[6]++;String.validate.notVoid(foodItem);cov_qrf8q3iqt().s[7]++;String.validate.notVoid(userId);cov_qrf8q3iqt().s[8]++;return(async()=>{cov_qrf8q3iqt().f[1]++;const user=(cov_qrf8q3iqt().s[9]++,await User.findById(userId));cov_qrf8q3iqt().s[10]++;if(!user){cov_qrf8q3iqt().b[0][0]++;cov_qrf8q3iqt().s[11]++;throw new UnexistenceError(`User with id ${userId} does not exist`);}else{cov_qrf8q3iqt().b[0][1]++;}const cohousing=(cov_qrf8q3iqt().s[12]++,await Cohousing.findOne({'members':ObjectId(userId)}));cov_qrf8q3iqt().s[13]++;if(!cohousing){cov_qrf8q3iqt().b[1][0]++;cov_qrf8q3iqt().s[14]++;throw new UnexistenceError(`There is no cohousing with a user with an id ${userId}`);}else{cov_qrf8q3iqt().b[1][1]++;}cov_qrf8q3iqt().s[15]++;const checkFruit=fruit=>{cov_qrf8q3iqt().f[2]++;cov_qrf8q3iqt().s[16]++;return fruit.name===foodItem;};cov_qrf8q3iqt().s[17]++;if(!user.foodList.some(checkFruit)){cov_qrf8q3iqt().b[2][0]++;cov_qrf8q3iqt().s[18]++;user.foodList.push({name:foodItem,weight:0.5});}else{cov_qrf8q3iqt().b[2][1]++;cov_qrf8q3iqt().s[19]++;for(index in user.foodList){cov_qrf8q3iqt().s[20]++;if(foodItem===user.foodList[index].name){cov_qrf8q3iqt().b[3][0]++;cov_qrf8q3iqt().s[21]++;user.foodList[index].weight=user.foodList[index].weight+0.5;}else{cov_qrf8q3iqt().b[3][1]++;}}}cov_qrf8q3iqt().s[22]++;if(!cohousing.foodList.some(checkFruit)){cov_qrf8q3iqt().b[4][0]++;cov_qrf8q3iqt().s[23]++;cohousing.foodList.push({name:foodItem,weight:0.5});}else{cov_qrf8q3iqt().b[4][1]++;cov_qrf8q3iqt().s[24]++;for(index in cohousing.foodList){cov_qrf8q3iqt().s[25]++;if(foodItem===cohousing.foodList[index].name){cov_qrf8q3iqt().b[5][0]++;cov_qrf8q3iqt().s[26]++;cohousing.foodList[index].weight=cohousing.foodList[index].weight+0.5;}else{cov_qrf8q3iqt().b[5][1]++;}}}cov_qrf8q3iqt().s[27]++;await user.save();cov_qrf8q3iqt().s[28]++;await cohousing.save();})();};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFkZC1mb29kLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJlcnJvcnMiLCJVbmV4aXN0ZW5jZUVycm9yIiwibW9kZWxzIiwiVXNlciIsIkNvaG91c2luZyIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJtb2R1bGUiLCJleHBvcnRzIiwiZm9vZEl0ZW0iLCJ1c2VySWQiLCJTdHJpbmciLCJ2YWxpZGF0ZSIsIm5vdFZvaWQiLCJ1c2VyIiwiZmluZEJ5SWQiLCJjb2hvdXNpbmciLCJmaW5kT25lIiwiY2hlY2tGcnVpdCIsImZydWl0IiwibmFtZSIsImZvb2RMaXN0Iiwic29tZSIsInB1c2giLCJ3ZWlnaHQiLCJpbmRleCIsInNhdmUiXSwibWFwcGluZ3MiOiJzbUlBZVk7Z0hBZlpBLE9BQU8sQ0FBQyxtQ0FBRCxDQUFQLEMsdUJBQ0FBLE9BQU8sQ0FBQyxpQ0FBRCxDQUFQLENBQ0EsS0FBTSxDQUFFQyxNQUFNLENBQUUsQ0FBRUMsZ0JBQUYsQ0FBViwwQkFBbUNGLE9BQU8sQ0FBQyxrQkFBRCxDQUExQyxDQUFOLENBQ0EsS0FBTSxDQUFFRyxNQUFNLENBQUUsQ0FBRUMsSUFBRixDQUFRQyxTQUFSLENBQVYsMEJBQWtDTCxPQUFPLENBQUMsZUFBRCxDQUF6QyxDQUFOLENBQ0EsS0FBTSxDQUFFTSxRQUFRLENBQUUsQ0FBRUMsUUFBRixDQUFaLDBCQUE2QlAsT0FBTyxDQUFDLGVBQUQsQ0FBcEMsQ0FBTixDLHVCQUdBUSxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsQ0FBQ0MsUUFBRCxDQUFXQyxNQUFYLEdBQXNCLCtDQUVuQ0MsTUFBTSxDQUFDQyxRQUFQLENBQWdCQyxPQUFoQixDQUF3QkosUUFBeEIsRUFGbUMsdUJBR25DRSxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLE9BQWhCLENBQXdCSCxNQUF4QixFQUhtQyx1QkFLbkMsTUFBTyxDQUFDLFNBQVksd0JBR2hCLEtBQU1JLENBQUFBLElBQUkseUJBQUcsS0FBTVgsQ0FBQUEsSUFBSSxDQUFDWSxRQUFMLENBQWNMLE1BQWQsQ0FBVCxDQUFWLENBSGdCLHdCQUloQixHQUFJLENBQUNJLElBQUwsQ0FBVyx3REFBTSxJQUFJYixDQUFBQSxnQkFBSixDQUFzQixnQkFBZVMsTUFBTyxpQkFBNUMsQ0FBTixDQUFtRSxDQUE5RSxnQ0FFQSxLQUFNTSxDQUFBQSxTQUFTLDBCQUFHLEtBQU1aLENBQUFBLFNBQVMsQ0FBQ2EsT0FBVixDQUFrQixDQUFFLFVBQVdYLFFBQVEsQ0FBQ0ksTUFBRCxDQUFyQixDQUFsQixDQUFULENBQWYsQ0FOZ0Isd0JBT2hCLEdBQUksQ0FBQ00sU0FBTCxDQUFnQix3REFBTSxJQUFJZixDQUFBQSxnQkFBSixDQUFzQixnREFBK0NTLE1BQU8sRUFBNUUsQ0FBTixDQUFvRixDQUFwRyxnQ0FQZ0Isd0JBU2hCLEtBQU1RLENBQUFBLFVBQVUsQ0FBR0MsS0FBSyxFQUFJLHNEQUFBQSxDQUFBQSxLQUFLLENBQUNDLElBQU4sR0FBZVgsUUFBZixDQUF1QixDQUFuRCxDQVRnQix3QkFXaEIsR0FBSSxDQUFDSyxJQUFJLENBQUNPLFFBQUwsQ0FBY0MsSUFBZCxDQUFtQkosVUFBbkIsQ0FBTCxDQUFxQyxtREFBRUosSUFBSSxDQUFDTyxRQUFMLENBQWNFLElBQWQsQ0FBbUIsQ0FBRUgsSUFBSSxDQUFFWCxRQUFSLENBQWtCZSxNQUFNLENBQUUsR0FBMUIsQ0FBbkIsRUFBcUQsQ0FBNUYsSUFDSyxtREFFRCxJQUFLQyxLQUFMLEdBQWNYLENBQUFBLElBQUksQ0FBQ08sUUFBbkIsQ0FBNkIseUJBRXpCLEdBQUlaLFFBQVEsR0FBS0ssSUFBSSxDQUFDTyxRQUFMLENBQWNJLEtBQWQsRUFBcUJMLElBQXRDLENBQTRDLG1EQUN4Q04sSUFBSSxDQUFDTyxRQUFMLENBQWNJLEtBQWQsRUFBcUJELE1BQXJCLENBQThCVixJQUFJLENBQUNPLFFBQUwsQ0FBY0ksS0FBZCxFQUFxQkQsTUFBckIsQ0FBOEIsR0FBNUQsQ0FDSCxDQUZELGdDQUdILENBQ0osQ0FwQmUsd0JBc0JoQixHQUFJLENBQUNSLFNBQVMsQ0FBQ0ssUUFBVixDQUFtQkMsSUFBbkIsQ0FBd0JKLFVBQXhCLENBQUwsQ0FBMEMsbURBQUVGLFNBQVMsQ0FBQ0ssUUFBVixDQUFtQkUsSUFBbkIsQ0FBd0IsQ0FBRUgsSUFBSSxDQUFFWCxRQUFSLENBQWtCZSxNQUFNLENBQUUsR0FBMUIsQ0FBeEIsRUFBMEQsQ0FBdEcsSUFDSyxtREFFRCxJQUFLQyxLQUFMLEdBQWNULENBQUFBLFNBQVMsQ0FBQ0ssUUFBeEIsQ0FBa0MseUJBRTlCLEdBQUlaLFFBQVEsR0FBS08sU0FBUyxDQUFDSyxRQUFWLENBQW1CSSxLQUFuQixFQUEwQkwsSUFBM0MsQ0FBaUQsbURBQzdDSixTQUFTLENBQUNLLFFBQVYsQ0FBbUJJLEtBQW5CLEVBQTBCRCxNQUExQixDQUFtQ1IsU0FBUyxDQUFDSyxRQUFWLENBQW1CSSxLQUFuQixFQUEwQkQsTUFBMUIsQ0FBbUMsR0FBdEUsQ0FDSCxDQUZELGdDQUdILENBQ0osQ0EvQmUsd0JBaUNoQixLQUFNVixDQUFBQSxJQUFJLENBQUNZLElBQUwsRUFBTixDQWpDZ0Isd0JBa0NoQixLQUFNVixDQUFBQSxTQUFTLENBQUNVLElBQVYsRUFBTixDQUdILENBckNNLEdBQVAsQ0FzQ0gsQ0EzQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCdjb29oYXBweS1jb21tb25zL3BvbHlmaWxscy9zdHJpbmcnKVxucmVxdWlyZSgnY29vaGFwcHktY29tbW9ucy9wb2x5ZmlsbHMvanNvbicpXG5jb25zdCB7IGVycm9yczogeyBVbmV4aXN0ZW5jZUVycm9yIH0gfSA9IHJlcXVpcmUoJ2Nvb2hhcHB5LWNvbW1vbnMnKVxuY29uc3QgeyBtb2RlbHM6IHsgVXNlciwgQ29ob3VzaW5nIH0gfSA9IHJlcXVpcmUoJ2Nvb2hhcHB5LWRhdGEnKVxuY29uc3QgeyBtb25nb29zZTogeyBPYmplY3RJZCB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1kYXRhJylcblxuXG5tb2R1bGUuZXhwb3J0cyA9IChmb29kSXRlbSwgdXNlcklkKSA9PiB7XG5cbiAgICBTdHJpbmcudmFsaWRhdGUubm90Vm9pZChmb29kSXRlbSlcbiAgICBTdHJpbmcudmFsaWRhdGUubm90Vm9pZCh1c2VySWQpXG5cbiAgICByZXR1cm4gKGFzeW5jICgpID0+IHtcblxuXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmZpbmRCeUlkKHVzZXJJZClcbiAgICAgICAgaWYgKCF1c2VyKSB0aHJvdyBuZXcgVW5leGlzdGVuY2VFcnJvcihgVXNlciB3aXRoIGlkICR7dXNlcklkfSBkb2VzIG5vdCBleGlzdGApXG5cbiAgICAgICAgY29uc3QgY29ob3VzaW5nID0gYXdhaXQgQ29ob3VzaW5nLmZpbmRPbmUoeyAnbWVtYmVycyc6IE9iamVjdElkKHVzZXJJZCkgfSlcbiAgICAgICAgaWYgKCFjb2hvdXNpbmcpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKGBUaGVyZSBpcyBubyBjb2hvdXNpbmcgd2l0aCBhIHVzZXIgd2l0aCBhbiBpZCAke3VzZXJJZH1gKVxuXG4gICAgICAgIGNvbnN0IGNoZWNrRnJ1aXQgPSBmcnVpdCA9PiBmcnVpdC5uYW1lID09PSBmb29kSXRlbVxuXG4gICAgICAgIGlmICghdXNlci5mb29kTGlzdC5zb21lKGNoZWNrRnJ1aXQpKSB7IHVzZXIuZm9vZExpc3QucHVzaCh7IG5hbWU6IGZvb2RJdGVtLCB3ZWlnaHQ6IDAuNSB9KSB9XG4gICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICBmb3IgKGluZGV4IGluIHVzZXIuZm9vZExpc3QpIHtcblxuICAgICAgICAgICAgICAgIGlmIChmb29kSXRlbSA9PT0gdXNlci5mb29kTGlzdFtpbmRleF0ubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICB1c2VyLmZvb2RMaXN0W2luZGV4XS53ZWlnaHQgPSB1c2VyLmZvb2RMaXN0W2luZGV4XS53ZWlnaHQgKyAwLjVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIWNvaG91c2luZy5mb29kTGlzdC5zb21lKGNoZWNrRnJ1aXQpKSB7IGNvaG91c2luZy5mb29kTGlzdC5wdXNoKHsgbmFtZTogZm9vZEl0ZW0sIHdlaWdodDogMC41IH0pIH1cbiAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgIGZvciAoaW5kZXggaW4gY29ob3VzaW5nLmZvb2RMaXN0KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZm9vZEl0ZW0gPT09IGNvaG91c2luZy5mb29kTGlzdFtpbmRleF0ubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICBjb2hvdXNpbmcuZm9vZExpc3RbaW5kZXhdLndlaWdodCA9IGNvaG91c2luZy5mb29kTGlzdFtpbmRleF0ud2VpZ2h0ICsgMC41XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgYXdhaXQgdXNlci5zYXZlKClcbiAgICAgICAgYXdhaXQgY29ob3VzaW5nLnNhdmUoKVxuXG5cbiAgICB9KSgpXG59Il19