function cov_2htigvzkop(){var path="/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/retrieve-messages.spec.js";var hash="74d0be4cd80f74e7672d7db6061e2dabdd6cd77e";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/retrieve-messages.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:51},end:{line:3,column:58}},"2":{start:{line:5,column:19},end:{line:5,column:34}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:25},end:{line:7,column:55}},"5":{start:{line:8,column:15},end:{line:8,column:34}},"6":{start:{line:9,column:40},end:{line:9,column:67}},"7":{start:{line:10,column:21},end:{line:10,column:45}},"8":{start:{line:11,column:73},end:{line:11,column:97}},"9":{start:{line:12,column:34},end:{line:12,column:61}},"10":{start:{line:16,column:0},end:{line:113,column:2}},"11":{start:{line:18,column:4},end:{line:18,column:47}},"12":{start:{line:18,column:17},end:{line:18,column:46}},"13":{start:{line:20,column:4},end:{line:55,column:6}},"14":{start:{line:22,column:8},end:{line:22,column:31}},"15":{start:{line:23,column:8},end:{line:23,column:36}},"16":{start:{line:24,column:8},end:{line:24,column:34}},"17":{start:{line:26,column:8},end:{line:26,column:33}},"18":{start:{line:27,column:8},end:{line:27,column:39}},"19":{start:{line:28,column:8},end:{line:28,column:40}},"20":{start:{line:29,column:8},end:{line:29,column:41}},"21":{start:{line:31,column:8},end:{line:31,column:42}},"22":{start:{line:32,column:8},end:{line:32,column:37}},"23":{start:{line:33,column:8},end:{line:33,column:25}},"24":{start:{line:34,column:8},end:{line:34,column:33}},"25":{start:{line:35,column:8},end:{line:35,column:43}},"26":{start:{line:36,column:8},end:{line:36,column:22}},"27":{start:{line:38,column:8},end:{line:38,column:45}},"28":{start:{line:39,column:8},end:{line:44,column:11}},"29":{start:{line:48,column:8},end:{line:48,column:46}},"30":{start:{line:49,column:21},end:{line:49,column:80}},"31":{start:{line:50,column:8},end:{line:50,column:24}},"32":{start:{line:51,column:22},end:{line:51,column:46}},"33":{start:{line:52,column:8},end:{line:52,column:123}},"34":{start:{line:57,column:4},end:{line:77,column:6}},"35":{start:{line:59,column:8},end:{line:65,column:10}},"36":{start:{line:60,column:30},end:{line:60,column:74}},"37":{start:{line:61,column:29},end:{line:61,column:82}},"38":{start:{line:63,column:12},end:{line:63,column:45}},"39":{start:{line:64,column:12},end:{line:64,column:34}},"40":{start:{line:67,column:8},end:{line:76,column:10}},"41":{start:{line:69,column:32},end:{line:69,column:62}},"42":{start:{line:70,column:33},end:{line:70,column:44}},"43":{start:{line:71,column:12},end:{line:71,column:37}},"44":{start:{line:72,column:12},end:{line:72,column:70}},"45":{start:{line:73,column:12},end:{line:73,column:63}},"46":{start:{line:74,column:12},end:{line:74,column:56}},"47":{start:{line:79,column:4},end:{line:93,column:6}},"48":{start:{line:82,column:8},end:{line:92,column:10}},"49":{start:{line:84,column:11},end:{line:91,column:12}},"50":{start:{line:85,column:15},end:{line:85,column:59}},"51":{start:{line:88,column:15},end:{line:88,column:37}},"52":{start:{line:89,column:15},end:{line:89,column:64}},"53":{start:{line:96,column:4},end:{line:104,column:6}},"54":{start:{line:98,column:8},end:{line:103,column:10}},"55":{start:{line:100,column:12},end:{line:100,column:92}},"56":{start:{line:100,column:25},end:{line:100,column:47}},"57":{start:{line:101,column:12},end:{line:101,column:102}},"58":{start:{line:101,column:25},end:{line:101,column:52}},"59":{start:{line:102,column:12},end:{line:102,column:86}},"60":{start:{line:102,column:25},end:{line:102,column:44}},"61":{start:{line:110,column:4},end:{line:110,column:38}},"62":{start:{line:110,column:20},end:{line:110,column:37}},"63":{start:{line:112,column:4},end:{line:112,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:38},end:{line:16,column:39}},loc:{start:{line:16,column:44},end:{line:113,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:18,column:11},end:{line:18,column:12}},loc:{start:{line:18,column:17},end:{line:18,column:46}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:15},end:{line:20,column:16}},loc:{start:{line:20,column:27},end:{line:55,column:5}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:57,column:57},end:{line:57,column:58}},loc:{start:{line:57,column:63},end:{line:77,column:5}},line:57},"4":{name:"(anonymous_4)",decl:{start:{line:59,column:20},end:{line:59,column:21}},loc:{start:{line:59,column:32},end:{line:65,column:9}},line:59},"5":{name:"(anonymous_5)",decl:{start:{line:67,column:50},end:{line:67,column:51}},loc:{start:{line:67,column:62},end:{line:76,column:9}},line:67},"6":{name:"(anonymous_6)",decl:{start:{line:79,column:56},end:{line:79,column:57}},loc:{start:{line:79,column:62},end:{line:93,column:5}},line:79},"7":{name:"(anonymous_7)",decl:{start:{line:82,column:46},end:{line:82,column:47}},loc:{start:{line:82,column:58},end:{line:92,column:9}},line:82},"8":{name:"(anonymous_8)",decl:{start:{line:96,column:28},end:{line:96,column:29}},loc:{start:{line:96,column:34},end:{line:104,column:5}},line:96},"9":{name:"(anonymous_9)",decl:{start:{line:98,column:36},end:{line:98,column:37}},loc:{start:{line:98,column:42},end:{line:103,column:9}},line:98},"10":{name:"(anonymous_10)",decl:{start:{line:100,column:19},end:{line:100,column:20}},loc:{start:{line:100,column:25},end:{line:100,column:47}},line:100},"11":{name:"(anonymous_11)",decl:{start:{line:101,column:19},end:{line:101,column:20}},loc:{start:{line:101,column:25},end:{line:101,column:52}},line:101},"12":{name:"(anonymous_12)",decl:{start:{line:102,column:19},end:{line:102,column:20}},loc:{start:{line:102,column:25},end:{line:102,column:44}},line:102},"13":{name:"(anonymous_13)",decl:{start:{line:110,column:14},end:{line:110,column:15}},loc:{start:{line:110,column:20},end:{line:110,column:37}},line:110}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"74d0be4cd80f74e7672d7db6061e2dabdd6cd77e"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2htigvzkop=function(){return actualCoverage;};}return actualCoverage;}cov_2htigvzkop();cov_2htigvzkop().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL}}=(cov_2htigvzkop().s[1]++,process);const{expect}=(cov_2htigvzkop().s[2]++,require('chai'));const{random}=(cov_2htigvzkop().s[3]++,Math);const retrieveMessages=(cov_2htigvzkop().s[4]++,require('./retrieve-messages'));const bcrypt=(cov_2htigvzkop().s[5]++,require('bcryptjs'));const{utils:{randomAccessCode}}=(cov_2htigvzkop().s[6]++,require('coohappy-commons'));const{mongoose}=(cov_2htigvzkop().s[7]++,require('coohappy-data'));const{mongoose:{ObjectId},models:{User,Cohousing,Message}}=(cov_2htigvzkop().s[8]++,require('coohappy-data'));const{errors:{VoidError}}=(cov_2htigvzkop().s[9]++,require('coohappy-commons'));let name,surname,email,password,hash,userId,nameCohousing,street,number,city,accessCode,message,date,laundryNum;cov_2htigvzkop().s[10]++;describe('logic - retrieve-messages',()=>{cov_2htigvzkop().f[0]++;cov_2htigvzkop().s[11]++;before(()=>{cov_2htigvzkop().f[1]++;cov_2htigvzkop().s[12]++;return mongoose.connect(MONGODB_URL);});cov_2htigvzkop().s[13]++;beforeEach(async()=>{cov_2htigvzkop().f[2]++;cov_2htigvzkop().s[14]++;await User.deleteMany();cov_2htigvzkop().s[15]++;await Cohousing.deleteMany();cov_2htigvzkop().s[16]++;await Message.deleteMany();cov_2htigvzkop().s[17]++;name=`name-${random()}`;cov_2htigvzkop().s[18]++;surname=`surname-${random()}`;cov_2htigvzkop().s[19]++;email=`e-${random()}@mail.com`;cov_2htigvzkop().s[20]++;password=`password-${random()}`;cov_2htigvzkop().s[21]++;nameCohousing=`name-${random()}`;cov_2htigvzkop().s[22]++;street=`street-${random()}`;cov_2htigvzkop().s[23]++;number=random();cov_2htigvzkop().s[24]++;city=`city-${random()}`;cov_2htigvzkop().s[25]++;accessCode=randomAccessCode(name);cov_2htigvzkop().s[26]++;laundryNum=4;cov_2htigvzkop().s[27]++;singleMessage=`message-${random()}`;cov_2htigvzkop().s[28]++;date={stringDay:"Tuesday",day:23,month:"June",hour:"16:34"};cov_2htigvzkop().s[29]++;hash=await bcrypt.hash(password,10);const user=(cov_2htigvzkop().s[30]++,await User.create({name,surname,email,password:hash}));cov_2htigvzkop().s[31]++;userId=user.id;let address=(cov_2htigvzkop().s[32]++,{street,number,city});cov_2htigvzkop().s[33]++;await Cohousing.create({name:nameCohousing,address,author:userId,accessCode,members:[userId],laundryNum});});cov_2htigvzkop().s[34]++;describe('when there are some messages to retrieve',()=>{cov_2htigvzkop().f[3]++;cov_2htigvzkop().s[35]++;beforeEach(async()=>{cov_2htigvzkop().f[4]++;const cohousing=(cov_2htigvzkop().s[36]++,await Cohousing.findOne({members:userId}));const _message=(cov_2htigvzkop().s[37]++,new Message({userId,message:singleMessage,date}));cov_2htigvzkop().s[38]++;cohousing.messages.push(_message);cov_2htigvzkop().s[39]++;await cohousing.save();});cov_2htigvzkop().s[40]++;it('should success on retrieve messages',async()=>{cov_2htigvzkop().f[5]++;const allMessages=(cov_2htigvzkop().s[41]++,await retrieveMessages(userId));const{messages}=(cov_2htigvzkop().s[42]++,allMessages);cov_2htigvzkop().s[43]++;expect(messages).to.exist;cov_2htigvzkop().s[44]++;expect(messages[0].userId._id.toString()).to.equal(userId);cov_2htigvzkop().s[45]++;expect(messages[0].message).to.equal(singleMessage);cov_2htigvzkop().s[46]++;expect(messages[0].date).to.deep.equal(date);});});cov_2htigvzkop().s[47]++;describe('when there are not messages to retrieve',()=>{cov_2htigvzkop().f[6]++;let allMessages;cov_2htigvzkop().s[48]++;it('should not retrieve any message',async()=>{cov_2htigvzkop().f[7]++;cov_2htigvzkop().s[49]++;try{cov_2htigvzkop().s[50]++;allMessages=await retrieveMessages(userId);}catch(error){cov_2htigvzkop().s[51]++;expect(error).to.exist;cov_2htigvzkop().s[52]++;expect(error.message).to.equal('no messages yet');}});});cov_2htigvzkop().s[53]++;describe('sync errors',()=>{cov_2htigvzkop().f[8]++;cov_2htigvzkop().s[54]++;it('on wrong type of data',()=>{cov_2htigvzkop().f[9]++;cov_2htigvzkop().s[55]++;expect(()=>{cov_2htigvzkop().f[10]++;cov_2htigvzkop().s[56]++;return retrieveMessages(true);}).to.throw(TypeError,'true is not a string');cov_2htigvzkop().s[57]++;expect(()=>{cov_2htigvzkop().f[11]++;cov_2htigvzkop().s[58]++;return retrieveMessages(undefined);}).to.throw(TypeError,'undefined is not a string');cov_2htigvzkop().s[59]++;expect(()=>{cov_2htigvzkop().f[12]++;cov_2htigvzkop().s[60]++;return retrieveMessages(2);}).to.throw(TypeError,'2 is not a string');});});cov_2htigvzkop().s[61]++;afterEach(()=>{cov_2htigvzkop().f[13]++;cov_2htigvzkop().s[62]++;return User.deleteMany();});cov_2htigvzkop().s[63]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLW1lc3NhZ2VzLnNwZWMuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImNvbmZpZyIsImVudiIsIlRFU1RfTU9OR09EQl9VUkwiLCJNT05HT0RCX1VSTCIsInByb2Nlc3MiLCJleHBlY3QiLCJyYW5kb20iLCJNYXRoIiwicmV0cmlldmVNZXNzYWdlcyIsImJjcnlwdCIsInV0aWxzIiwicmFuZG9tQWNjZXNzQ29kZSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJtb2RlbHMiLCJVc2VyIiwiQ29ob3VzaW5nIiwiTWVzc2FnZSIsImVycm9ycyIsIlZvaWRFcnJvciIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwYXNzd29yZCIsImhhc2giLCJ1c2VySWQiLCJuYW1lQ29ob3VzaW5nIiwic3RyZWV0IiwibnVtYmVyIiwiY2l0eSIsImFjY2Vzc0NvZGUiLCJtZXNzYWdlIiwiZGF0ZSIsImxhdW5kcnlOdW0iLCJkZXNjcmliZSIsImJlZm9yZSIsImNvbm5lY3QiLCJiZWZvcmVFYWNoIiwiZGVsZXRlTWFueSIsInNpbmdsZU1lc3NhZ2UiLCJzdHJpbmdEYXkiLCJkYXkiLCJtb250aCIsImhvdXIiLCJ1c2VyIiwiY3JlYXRlIiwiaWQiLCJhZGRyZXNzIiwiYXV0aG9yIiwibWVtYmVycyIsImNvaG91c2luZyIsImZpbmRPbmUiLCJfbWVzc2FnZSIsIm1lc3NhZ2VzIiwicHVzaCIsInNhdmUiLCJpdCIsImFsbE1lc3NhZ2VzIiwidG8iLCJleGlzdCIsIl9pZCIsInRvU3RyaW5nIiwiZXF1YWwiLCJkZWVwIiwiZXJyb3IiLCJ0aHJvdyIsIlR5cGVFcnJvciIsInVuZGVmaW5lZCIsImFmdGVyRWFjaCIsImFmdGVyIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6IjJ6TkFlWTttSEFmWkEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkMsTUFBbEIsR0FFQSxLQUFNLENBQUVDLEdBQUcsQ0FBRSxDQUFFQyxnQkFBZ0IsQ0FBRUMsV0FBcEIsQ0FBUCwyQkFBNkND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QVEsQ0FBQyxhQUFELENBQWdCLElBQU0sa0RBRTFCc0IsRUFBRSxDQUFDLHVCQUFELENBQTBCLElBQU0sa0RBRTlCbkQsTUFBTSxDQUFDLElBQU0seURBQUFHLENBQUFBLGdCQUFnQixDQUFDLElBQUQsQ0FBaEIsQ0FBc0IsQ0FBN0IsQ0FBTixDQUFxQ2tELEVBQXJDLENBQXdDTyxLQUF4QyxDQUE4Q0MsU0FBOUMsQ0FBeUQsc0JBQXpELEVBRjhCLHlCQUc5QjdELE1BQU0sQ0FBQyxJQUFNLHlEQUFBRyxDQUFBQSxnQkFBZ0IsQ0FBQzJELFNBQUQsQ0FBaEIsQ0FBMkIsQ0FBbEMsQ0FBTixDQUEwQ1QsRUFBMUMsQ0FBNkNPLEtBQTdDLENBQW1EQyxTQUFuRCxDQUE4RCwyQkFBOUQsRUFIOEIseUJBSTlCN0QsTUFBTSxDQUFDLElBQU0seURBQUFHLENBQUFBLGdCQUFnQixDQUFDLENBQUQsQ0FBaEIsQ0FBbUIsQ0FBMUIsQ0FBTixDQUFrQ2tELEVBQWxDLENBQXFDTyxLQUFyQyxDQUEyQ0MsU0FBM0MsQ0FBc0QsbUJBQXRELEVBQ0gsQ0FMQyxDQUFGLENBTUgsQ0FSTyxDQUFSLENBaEZ3Qyx5QkE4RnhDRSxTQUFTLENBQUMsSUFBTSx5REFBQXJELENBQUFBLElBQUksQ0FBQ3VCLFVBQUwsR0FBaUIsQ0FBeEIsQ0FBVCxDQTlGd0MseUJBZ0d4QytCLEtBQUssQ0FBQ3pELFFBQVEsQ0FBQzBELFVBQVYsQ0FBTCxDQUNILENBakdPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKVxuXG5jb25zdCB7IGVudjogeyBURVNUX01PTkdPREJfVVJMOiBNT05HT0RCX1VSTCB9IH0gPSBwcm9jZXNzXG5cbmNvbnN0IHsgZXhwZWN0IH0gPSByZXF1aXJlKCdjaGFpJylcbmNvbnN0IHsgcmFuZG9tIH0gPSBNYXRoXG5jb25zdCByZXRyaWV2ZU1lc3NhZ2VzID0gcmVxdWlyZSgnLi9yZXRyaWV2ZS1tZXNzYWdlcycpXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpXG5jb25zdCB7IHV0aWxzOiB7IHJhbmRvbUFjY2Vzc0NvZGUgfSB9ID0gcmVxdWlyZSgnY29vaGFwcHktY29tbW9ucycpXG5jb25zdCB7IG1vbmdvb3NlIH0gPSByZXF1aXJlKCdjb29oYXBweS1kYXRhJylcbmNvbnN0IHsgbW9uZ29vc2U6IHsgT2JqZWN0SWQgfSwgbW9kZWxzOiB7IFVzZXIsIENvaG91c2luZywgTWVzc2FnZSB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1kYXRhJylcbmNvbnN0IHsgZXJyb3JzOiB7IFZvaWRFcnJvciB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1jb21tb25zJylcblxubGV0IG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZCwgaGFzaCwgdXNlcklkLCBuYW1lQ29ob3VzaW5nLCBzdHJlZXQsIG51bWJlciwgY2l0eSwgYWNjZXNzQ29kZSwgbWVzc2FnZSwgZGF0ZSwgbGF1bmRyeU51bVxuXG5kZXNjcmliZSgnbG9naWMgLSByZXRyaWV2ZS1tZXNzYWdlcycsICgpID0+IHtcblxuICAgIGJlZm9yZSgoKSA9PiBtb25nb29zZS5jb25uZWN0KE1PTkdPREJfVVJMKSlcblxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuXG4gICAgICAgIGF3YWl0IFVzZXIuZGVsZXRlTWFueSgpXG4gICAgICAgIGF3YWl0IENvaG91c2luZy5kZWxldGVNYW55KClcbiAgICAgICAgYXdhaXQgTWVzc2FnZS5kZWxldGVNYW55KClcblxuICAgICAgICBuYW1lID0gYG5hbWUtJHtyYW5kb20oKX1gXG4gICAgICAgIHN1cm5hbWUgPSBgc3VybmFtZS0ke3JhbmRvbSgpfWBcbiAgICAgICAgZW1haWwgPSBgZS0ke3JhbmRvbSgpfUBtYWlsLmNvbWBcbiAgICAgICAgcGFzc3dvcmQgPSBgcGFzc3dvcmQtJHtyYW5kb20oKX1gXG5cbiAgICAgICAgbmFtZUNvaG91c2luZyA9IGBuYW1lLSR7cmFuZG9tKCl9YFxuICAgICAgICBzdHJlZXQgPSBgc3RyZWV0LSR7cmFuZG9tKCl9YFxuICAgICAgICBudW1iZXIgPSByYW5kb20oKVxuICAgICAgICBjaXR5ID0gYGNpdHktJHtyYW5kb20oKX1gXG4gICAgICAgIGFjY2Vzc0NvZGUgPSByYW5kb21BY2Nlc3NDb2RlKG5hbWUpXG4gICAgICAgIGxhdW5kcnlOdW0gPSA0XG5cbiAgICAgICAgc2luZ2xlTWVzc2FnZSA9IGBtZXNzYWdlLSR7cmFuZG9tKCl9YFxuICAgICAgICBkYXRlID0ge1xuICAgICAgICAgICAgc3RyaW5nRGF5OiBcIlR1ZXNkYXlcIixcbiAgICAgICAgICAgIGRheTogMjMsXG4gICAgICAgICAgICBtb250aDogXCJKdW5lXCIsXG4gICAgICAgICAgICBob3VyOiBcIjE2OjM0XCJcbiAgICAgICAgICB9XG5cblxuXG4gICAgICAgIGhhc2ggPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTApXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7IG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZDogaGFzaCB9KVxuICAgICAgICB1c2VySWQgPSB1c2VyLmlkXG4gICAgICAgIGxldCBhZGRyZXNzID0geyBzdHJlZXQsIG51bWJlciwgY2l0eSB9XG4gICAgICAgIGF3YWl0IENvaG91c2luZy5jcmVhdGUoeyBuYW1lOiBuYW1lQ29ob3VzaW5nLCBhZGRyZXNzLCBhdXRob3I6IHVzZXJJZCwgYWNjZXNzQ29kZSwgbWVtYmVyczogW3VzZXJJZF0sIGxhdW5kcnlOdW0gfSlcblxuICAgICAgICBcbiAgICB9KVxuXG4gICAgZGVzY3JpYmUoJ3doZW4gdGhlcmUgYXJlIHNvbWUgbWVzc2FnZXMgdG8gcmV0cmlldmUnLCAoKSA9PiB7XG5cbiAgICAgICAgYmVmb3JlRWFjaCggYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29ob3VzaW5nID0gYXdhaXQgQ29ob3VzaW5nLmZpbmRPbmUoeyBtZW1iZXJzOiB1c2VySWQgfSlcbiAgICAgICAgICAgIGNvbnN0IF9tZXNzYWdlID0gbmV3IE1lc3NhZ2UoeyB1c2VySWQsIG1lc3NhZ2U6IHNpbmdsZU1lc3NhZ2UsIGRhdGUgfSlcbiAgICBcbiAgICAgICAgICAgIGNvaG91c2luZy5tZXNzYWdlcy5wdXNoKF9tZXNzYWdlKVxuICAgICAgICAgICAgYXdhaXQgY29ob3VzaW5nLnNhdmUoKVxuICAgICAgICB9KVxuXG4gICAgICAgIGl0KCdzaG91bGQgc3VjY2VzcyBvbiByZXRyaWV2ZSBtZXNzYWdlcycsIGFzeW5jICgpID0+IHtcblxuICAgICAgICAgICAgY29uc3QgYWxsTWVzc2FnZXMgPSBhd2FpdCByZXRyaWV2ZU1lc3NhZ2VzKHVzZXJJZClcbiAgICAgICAgICAgIGNvbnN0IHsgbWVzc2FnZXMgfSA9IGFsbE1lc3NhZ2VzXG4gICAgICAgICAgICBleHBlY3QobWVzc2FnZXMpLnRvLmV4aXN0XG4gICAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0udXNlcklkLl9pZC50b1N0cmluZygpKS50by5lcXVhbCh1c2VySWQpXG4gICAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0ubWVzc2FnZSkudG8uZXF1YWwoc2luZ2xlTWVzc2FnZSlcbiAgICAgICAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5kYXRlKS50by5kZWVwLmVxdWFsKGRhdGUpXG5cbiAgICAgICAgfSlcbiAgICB9KVxuXG4gICAgZGVzY3JpYmUoJ3doZW4gdGhlcmUgYXJlIG5vdCBtZXNzYWdlcyB0byByZXRyaWV2ZScsICgpID0+IHtcbiAgICAgICAgbGV0IGFsbE1lc3NhZ2VzXG4gICAgICBcbiAgICAgICAgaXQoJ3Nob3VsZCBub3QgcmV0cmlldmUgYW55IG1lc3NhZ2UnLCBhc3luYyAoKSA9PiB7XG5cbiAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgYWxsTWVzc2FnZXMgPSBhd2FpdCByZXRyaWV2ZU1lc3NhZ2VzKHVzZXJJZClcblxuICAgICAgICAgICB9Y2F0Y2goZXJyb3Ipe1xuICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yKS50by5leGlzdFxuICAgICAgICAgICAgICAgZXhwZWN0KGVycm9yLm1lc3NhZ2UpLnRvLmVxdWFsKCdubyBtZXNzYWdlcyB5ZXQnKVxuXG4gICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KVxuXG5cbiAgICBkZXNjcmliZSgnc3luYyBlcnJvcnMnLCAoKSA9PiB7XG5cbiAgICAgICAgaXQoJ29uIHdyb25nIHR5cGUgb2YgZGF0YScsICgpID0+IHtcblxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHJldHJpZXZlTWVzc2FnZXModHJ1ZSkpLnRvLnRocm93KFR5cGVFcnJvciwgJ3RydWUgaXMgbm90IGEgc3RyaW5nJylcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiByZXRyaWV2ZU1lc3NhZ2VzKHVuZGVmaW5lZCkpLnRvLnRocm93KFR5cGVFcnJvciwgJ3VuZGVmaW5lZCBpcyBub3QgYSBzdHJpbmcnKVxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHJldHJpZXZlTWVzc2FnZXMoMikpLnRvLnRocm93KFR5cGVFcnJvciwgJzIgaXMgbm90IGEgc3RyaW5nJylcbiAgICAgICAgfSlcbiAgICB9KVxuXG5cblxuXG5cbiAgICBhZnRlckVhY2goKCkgPT4gVXNlci5kZWxldGVNYW55KCkpXG5cbiAgICBhZnRlcihtb25nb29zZS5kaXNjb25uZWN0KVxufSkiXX0=