function cov_2htigvzkop(){var path="/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/retrieve-messages.spec.js";var hash="eb00d652db73c96ba8863efd053a44fbed1166d3";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/retrieve-messages.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:51},end:{line:3,column:58}},"2":{start:{line:5,column:19},end:{line:5,column:34}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:25},end:{line:7,column:55}},"5":{start:{line:8,column:15},end:{line:8,column:34}},"6":{start:{line:9,column:40},end:{line:9,column:67}},"7":{start:{line:10,column:21},end:{line:10,column:45}},"8":{start:{line:11,column:73},end:{line:11,column:97}},"9":{start:{line:12,column:34},end:{line:12,column:61}},"10":{start:{line:16,column:0},end:{line:113,column:2}},"11":{start:{line:18,column:4},end:{line:18,column:47}},"12":{start:{line:18,column:17},end:{line:18,column:46}},"13":{start:{line:20,column:4},end:{line:55,column:6}},"14":{start:{line:22,column:8},end:{line:22,column:31}},"15":{start:{line:23,column:8},end:{line:23,column:36}},"16":{start:{line:24,column:8},end:{line:24,column:34}},"17":{start:{line:26,column:8},end:{line:26,column:33}},"18":{start:{line:27,column:8},end:{line:27,column:39}},"19":{start:{line:28,column:8},end:{line:28,column:40}},"20":{start:{line:29,column:8},end:{line:29,column:41}},"21":{start:{line:31,column:8},end:{line:31,column:42}},"22":{start:{line:32,column:8},end:{line:32,column:37}},"23":{start:{line:33,column:8},end:{line:33,column:25}},"24":{start:{line:34,column:8},end:{line:34,column:33}},"25":{start:{line:35,column:8},end:{line:35,column:43}},"26":{start:{line:36,column:8},end:{line:36,column:22}},"27":{start:{line:38,column:8},end:{line:38,column:45}},"28":{start:{line:39,column:8},end:{line:44,column:11}},"29":{start:{line:48,column:8},end:{line:48,column:46}},"30":{start:{line:49,column:21},end:{line:49,column:80}},"31":{start:{line:50,column:8},end:{line:50,column:24}},"32":{start:{line:51,column:22},end:{line:51,column:46}},"33":{start:{line:52,column:8},end:{line:52,column:123}},"34":{start:{line:57,column:4},end:{line:77,column:6}},"35":{start:{line:59,column:8},end:{line:65,column:10}},"36":{start:{line:60,column:30},end:{line:60,column:74}},"37":{start:{line:61,column:29},end:{line:61,column:82}},"38":{start:{line:63,column:12},end:{line:63,column:45}},"39":{start:{line:64,column:12},end:{line:64,column:34}},"40":{start:{line:67,column:8},end:{line:76,column:10}},"41":{start:{line:69,column:32},end:{line:69,column:62}},"42":{start:{line:70,column:33},end:{line:70,column:44}},"43":{start:{line:71,column:12},end:{line:71,column:37}},"44":{start:{line:72,column:12},end:{line:72,column:70}},"45":{start:{line:73,column:12},end:{line:73,column:63}},"46":{start:{line:74,column:12},end:{line:74,column:51}},"47":{start:{line:79,column:4},end:{line:93,column:6}},"48":{start:{line:82,column:8},end:{line:92,column:10}},"49":{start:{line:84,column:11},end:{line:91,column:12}},"50":{start:{line:85,column:15},end:{line:85,column:59}},"51":{start:{line:88,column:15},end:{line:88,column:37}},"52":{start:{line:89,column:15},end:{line:89,column:64}},"53":{start:{line:96,column:4},end:{line:104,column:6}},"54":{start:{line:98,column:8},end:{line:103,column:10}},"55":{start:{line:100,column:12},end:{line:100,column:92}},"56":{start:{line:100,column:25},end:{line:100,column:47}},"57":{start:{line:101,column:12},end:{line:101,column:102}},"58":{start:{line:101,column:25},end:{line:101,column:52}},"59":{start:{line:102,column:12},end:{line:102,column:86}},"60":{start:{line:102,column:25},end:{line:102,column:44}},"61":{start:{line:110,column:4},end:{line:110,column:38}},"62":{start:{line:110,column:20},end:{line:110,column:37}},"63":{start:{line:112,column:4},end:{line:112,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:43},end:{line:16,column:44}},loc:{start:{line:16,column:49},end:{line:113,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:18,column:11},end:{line:18,column:12}},loc:{start:{line:18,column:17},end:{line:18,column:46}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:15},end:{line:20,column:16}},loc:{start:{line:20,column:27},end:{line:55,column:5}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:57,column:57},end:{line:57,column:58}},loc:{start:{line:57,column:63},end:{line:77,column:5}},line:57},"4":{name:"(anonymous_4)",decl:{start:{line:59,column:20},end:{line:59,column:21}},loc:{start:{line:59,column:32},end:{line:65,column:9}},line:59},"5":{name:"(anonymous_5)",decl:{start:{line:67,column:50},end:{line:67,column:51}},loc:{start:{line:67,column:62},end:{line:76,column:9}},line:67},"6":{name:"(anonymous_6)",decl:{start:{line:79,column:56},end:{line:79,column:57}},loc:{start:{line:79,column:62},end:{line:93,column:5}},line:79},"7":{name:"(anonymous_7)",decl:{start:{line:82,column:46},end:{line:82,column:47}},loc:{start:{line:82,column:58},end:{line:92,column:9}},line:82},"8":{name:"(anonymous_8)",decl:{start:{line:96,column:28},end:{line:96,column:29}},loc:{start:{line:96,column:34},end:{line:104,column:5}},line:96},"9":{name:"(anonymous_9)",decl:{start:{line:98,column:36},end:{line:98,column:37}},loc:{start:{line:98,column:42},end:{line:103,column:9}},line:98},"10":{name:"(anonymous_10)",decl:{start:{line:100,column:19},end:{line:100,column:20}},loc:{start:{line:100,column:25},end:{line:100,column:47}},line:100},"11":{name:"(anonymous_11)",decl:{start:{line:101,column:19},end:{line:101,column:20}},loc:{start:{line:101,column:25},end:{line:101,column:52}},line:101},"12":{name:"(anonymous_12)",decl:{start:{line:102,column:19},end:{line:102,column:20}},loc:{start:{line:102,column:25},end:{line:102,column:44}},line:102},"13":{name:"(anonymous_13)",decl:{start:{line:110,column:14},end:{line:110,column:15}},loc:{start:{line:110,column:20},end:{line:110,column:37}},line:110}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"eb00d652db73c96ba8863efd053a44fbed1166d3"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2htigvzkop=function(){return actualCoverage;};}return actualCoverage;}cov_2htigvzkop();cov_2htigvzkop().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL}}=(cov_2htigvzkop().s[1]++,process);const{expect}=(cov_2htigvzkop().s[2]++,require('chai'));const{random}=(cov_2htigvzkop().s[3]++,Math);const retrieveMessages=(cov_2htigvzkop().s[4]++,require('./retrieve-messages'));const bcrypt=(cov_2htigvzkop().s[5]++,require('bcryptjs'));const{utils:{randomAccessCode}}=(cov_2htigvzkop().s[6]++,require('coohappy-commons'));const{mongoose}=(cov_2htigvzkop().s[7]++,require('coohappy-data'));const{mongoose:{ObjectId},models:{User,Cohousing,Message}}=(cov_2htigvzkop().s[8]++,require('coohappy-data'));const{errors:{VoidError}}=(cov_2htigvzkop().s[9]++,require('coohappy-commons'));let name,surname,email,password,hash,userId,nameCohousing,street,number,city,accessCode,message,date,laundryNum;cov_2htigvzkop().s[10]++;describe.only('logic - retrieve-messages',()=>{cov_2htigvzkop().f[0]++;cov_2htigvzkop().s[11]++;before(()=>{cov_2htigvzkop().f[1]++;cov_2htigvzkop().s[12]++;return mongoose.connect(MONGODB_URL);});cov_2htigvzkop().s[13]++;beforeEach(async()=>{cov_2htigvzkop().f[2]++;cov_2htigvzkop().s[14]++;await User.deleteMany();cov_2htigvzkop().s[15]++;await Cohousing.deleteMany();cov_2htigvzkop().s[16]++;await Message.deleteMany();cov_2htigvzkop().s[17]++;name=`name-${random()}`;cov_2htigvzkop().s[18]++;surname=`surname-${random()}`;cov_2htigvzkop().s[19]++;email=`e-${random()}@mail.com`;cov_2htigvzkop().s[20]++;password=`password-${random()}`;cov_2htigvzkop().s[21]++;nameCohousing=`name-${random()}`;cov_2htigvzkop().s[22]++;street=`street-${random()}`;cov_2htigvzkop().s[23]++;number=random();cov_2htigvzkop().s[24]++;city=`city-${random()}`;cov_2htigvzkop().s[25]++;accessCode=randomAccessCode(name);cov_2htigvzkop().s[26]++;laundryNum=4;cov_2htigvzkop().s[27]++;singleMessage=`message-${random()}`;cov_2htigvzkop().s[28]++;date={stringDay:"Tuesday",day:23,month:"June",hour:"16:34"};cov_2htigvzkop().s[29]++;hash=await bcrypt.hash(password,10);const user=(cov_2htigvzkop().s[30]++,await User.create({name,surname,email,password:hash}));cov_2htigvzkop().s[31]++;userId=user.id;let address=(cov_2htigvzkop().s[32]++,{street,number,city});cov_2htigvzkop().s[33]++;await Cohousing.create({name:nameCohousing,address,author:userId,accessCode,members:[userId],laundryNum});});cov_2htigvzkop().s[34]++;describe('when there are some messages to retrieve',()=>{cov_2htigvzkop().f[3]++;cov_2htigvzkop().s[35]++;beforeEach(async()=>{cov_2htigvzkop().f[4]++;const cohousing=(cov_2htigvzkop().s[36]++,await Cohousing.findOne({members:userId}));const _message=(cov_2htigvzkop().s[37]++,new Message({userId,message:singleMessage,date}));cov_2htigvzkop().s[38]++;cohousing.messages.push(_message);cov_2htigvzkop().s[39]++;await cohousing.save();});cov_2htigvzkop().s[40]++;it('should success on retrieve messages',async()=>{cov_2htigvzkop().f[5]++;const allMessages=(cov_2htigvzkop().s[41]++,await retrieveMessages(userId));const{messages}=(cov_2htigvzkop().s[42]++,allMessages);cov_2htigvzkop().s[43]++;expect(messages).to.exist;cov_2htigvzkop().s[44]++;expect(messages[0].userId._id.toString()).to.equal(userId);cov_2htigvzkop().s[45]++;expect(messages[0].message).to.equal(singleMessage);cov_2htigvzkop().s[46]++;expect(messages[0].date).to.equal(date);});});cov_2htigvzkop().s[47]++;describe('when there are not messages to retrieve',()=>{cov_2htigvzkop().f[6]++;let allMessages;cov_2htigvzkop().s[48]++;it('should not retrieve any message',async()=>{cov_2htigvzkop().f[7]++;cov_2htigvzkop().s[49]++;try{cov_2htigvzkop().s[50]++;allMessages=await retrieveMessages(userId);}catch(error){cov_2htigvzkop().s[51]++;expect(error).to.exist;cov_2htigvzkop().s[52]++;expect(error.message).to.equal('no messages yet');}});});cov_2htigvzkop().s[53]++;describe('sync errors',()=>{cov_2htigvzkop().f[8]++;cov_2htigvzkop().s[54]++;it('on wrong type of data',()=>{cov_2htigvzkop().f[9]++;cov_2htigvzkop().s[55]++;expect(()=>{cov_2htigvzkop().f[10]++;cov_2htigvzkop().s[56]++;return retrieveMessages(true);}).to.throw(TypeError,'true is not a string');cov_2htigvzkop().s[57]++;expect(()=>{cov_2htigvzkop().f[11]++;cov_2htigvzkop().s[58]++;return retrieveMessages(undefined);}).to.throw(TypeError,'undefined is not a string');cov_2htigvzkop().s[59]++;expect(()=>{cov_2htigvzkop().f[12]++;cov_2htigvzkop().s[60]++;return retrieveMessages(2);}).to.throw(TypeError,'2 is not a string');});});cov_2htigvzkop().s[61]++;afterEach(()=>{cov_2htigvzkop().f[13]++;cov_2htigvzkop().s[62]++;return User.deleteMany();});cov_2htigvzkop().s[63]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLW1lc3NhZ2VzLnNwZWMuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImNvbmZpZyIsImVudiIsIlRFU1RfTU9OR09EQl9VUkwiLCJNT05HT0RCX1VSTCIsInByb2Nlc3MiLCJleHBlY3QiLCJyYW5kb20iLCJNYXRoIiwicmV0cmlldmVNZXNzYWdlcyIsImJjcnlwdCIsInV0aWxzIiwicmFuZG9tQWNjZXNzQ29kZSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJtb2RlbHMiLCJVc2VyIiwiQ29ob3VzaW5nIiwiTWVzc2FnZSIsImVycm9ycyIsIlZvaWRFcnJvciIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwYXNzd29yZCIsImhhc2giLCJ1c2VySWQiLCJuYW1lQ29ob3VzaW5nIiwic3RyZWV0IiwibnVtYmVyIiwiY2l0eSIsImFjY2Vzc0NvZGUiLCJtZXNzYWdlIiwiZGF0ZSIsImxhdW5kcnlOdW0iLCJkZXNjcmliZSIsIm9ubHkiLCJiZWZvcmUiLCJjb25uZWN0IiwiYmVmb3JlRWFjaCIsImRlbGV0ZU1hbnkiLCJzaW5nbGVNZXNzYWdlIiwic3RyaW5nRGF5IiwiZGF5IiwibW9udGgiLCJob3VyIiwidXNlciIsImNyZWF0ZSIsImlkIiwiYWRkcmVzcyIsImF1dGhvciIsIm1lbWJlcnMiLCJjb2hvdXNpbmciLCJmaW5kT25lIiwiX21lc3NhZ2UiLCJtZXNzYWdlcyIsInB1c2giLCJzYXZlIiwiaXQiLCJhbGxNZXNzYWdlcyIsInRvIiwiZXhpc3QiLCJfaWQiLCJ0b1N0cmluZyIsImVxdWFsIiwiZXJyb3IiLCJ0aHJvdyIsIlR5cGVFcnJvciIsInVuZGVmaW5lZCIsImFmdGVyRWFjaCIsImFmdGVyIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6IjJ6TkFlWTttSEFmWkEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkMsTUFBbEIsR0FFQSxLQUFNLENBQUVDLEdBQUcsQ0FBRSxDQUFFQyxnQkFBZ0IsQ0FBRUMsV0FBcEIsQ0FBUCwyQkFBNkND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LENBQUMsYUFBRCxDQUFnQixJQUFNLGtEQUUxQnVCLEVBQUUsQ0FBQyx1QkFBRCxDQUEwQixJQUFNLGtEQUU5QnBELE1BQU0sQ0FBQyxJQUFNLHlEQUFBRyxDQUFBQSxnQkFBZ0IsQ0FBQyxJQUFELENBQWhCLENBQXNCLENBQTdCLENBQU4sQ0FBcUNtRCxFQUFyQyxDQUF3Q00sS0FBeEMsQ0FBOENDLFNBQTlDLENBQXlELHNCQUF6RCxFQUY4Qix5QkFHOUI3RCxNQUFNLENBQUMsSUFBTSx5REFBQUcsQ0FBQUEsZ0JBQWdCLENBQUMyRCxTQUFELENBQWhCLENBQTJCLENBQWxDLENBQU4sQ0FBMENSLEVBQTFDLENBQTZDTSxLQUE3QyxDQUFtREMsU0FBbkQsQ0FBOEQsMkJBQTlELEVBSDhCLHlCQUk5QjdELE1BQU0sQ0FBQyxJQUFNLHlEQUFBRyxDQUFBQSxnQkFBZ0IsQ0FBQyxDQUFELENBQWhCLENBQW1CLENBQTFCLENBQU4sQ0FBa0NtRCxFQUFsQyxDQUFxQ00sS0FBckMsQ0FBMkNDLFNBQTNDLENBQXNELG1CQUF0RCxFQUNILENBTEMsQ0FBRixDQU1ILENBUk8sQ0FBUixDQWhGNkMseUJBOEY3Q0UsU0FBUyxDQUFDLElBQU0seURBQUFyRCxDQUFBQSxJQUFJLENBQUN3QixVQUFMLEdBQWlCLENBQXhCLENBQVQsQ0E5RjZDLHlCQWdHN0M4QixLQUFLLENBQUN6RCxRQUFRLENBQUMwRCxVQUFWLENBQUwsQ0FDSCxDQWpHRCIsInNvdXJjZXNDb250ZW50IjpbInJlcXVpcmUoJ2RvdGVudicpLmNvbmZpZygpXG5cbmNvbnN0IHsgZW52OiB7IFRFU1RfTU9OR09EQl9VUkw6IE1PTkdPREJfVVJMIH0gfSA9IHByb2Nlc3NcblxuY29uc3QgeyBleHBlY3QgfSA9IHJlcXVpcmUoJ2NoYWknKVxuY29uc3QgeyByYW5kb20gfSA9IE1hdGhcbmNvbnN0IHJldHJpZXZlTWVzc2FnZXMgPSByZXF1aXJlKCcuL3JldHJpZXZlLW1lc3NhZ2VzJylcbmNvbnN0IGJjcnlwdCA9IHJlcXVpcmUoJ2JjcnlwdGpzJylcbmNvbnN0IHsgdXRpbHM6IHsgcmFuZG9tQWNjZXNzQ29kZSB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1jb21tb25zJylcbmNvbnN0IHsgbW9uZ29vc2UgfSA9IHJlcXVpcmUoJ2Nvb2hhcHB5LWRhdGEnKVxuY29uc3QgeyBtb25nb29zZTogeyBPYmplY3RJZCB9LCBtb2RlbHM6IHsgVXNlciwgQ29ob3VzaW5nLCBNZXNzYWdlIH0gfSA9IHJlcXVpcmUoJ2Nvb2hhcHB5LWRhdGEnKVxuY29uc3QgeyBlcnJvcnM6IHsgVm9pZEVycm9yIH0gfSA9IHJlcXVpcmUoJ2Nvb2hhcHB5LWNvbW1vbnMnKVxuXG5sZXQgbmFtZSwgc3VybmFtZSwgZW1haWwsIHBhc3N3b3JkLCBoYXNoLCB1c2VySWQsIG5hbWVDb2hvdXNpbmcsIHN0cmVldCwgbnVtYmVyLCBjaXR5LCBhY2Nlc3NDb2RlLCBtZXNzYWdlLCBkYXRlLCBsYXVuZHJ5TnVtXG5cbmRlc2NyaWJlLm9ubHkoJ2xvZ2ljIC0gcmV0cmlldmUtbWVzc2FnZXMnLCAoKSA9PiB7XG5cbiAgICBiZWZvcmUoKCkgPT4gbW9uZ29vc2UuY29ubmVjdChNT05HT0RCX1VSTCkpXG5cbiAgICBiZWZvcmVFYWNoKGFzeW5jICgpID0+IHtcblxuICAgICAgICBhd2FpdCBVc2VyLmRlbGV0ZU1hbnkoKVxuICAgICAgICBhd2FpdCBDb2hvdXNpbmcuZGVsZXRlTWFueSgpXG4gICAgICAgIGF3YWl0IE1lc3NhZ2UuZGVsZXRlTWFueSgpXG5cbiAgICAgICAgbmFtZSA9IGBuYW1lLSR7cmFuZG9tKCl9YFxuICAgICAgICBzdXJuYW1lID0gYHN1cm5hbWUtJHtyYW5kb20oKX1gXG4gICAgICAgIGVtYWlsID0gYGUtJHtyYW5kb20oKX1AbWFpbC5jb21gXG4gICAgICAgIHBhc3N3b3JkID0gYHBhc3N3b3JkLSR7cmFuZG9tKCl9YFxuXG4gICAgICAgIG5hbWVDb2hvdXNpbmcgPSBgbmFtZS0ke3JhbmRvbSgpfWBcbiAgICAgICAgc3RyZWV0ID0gYHN0cmVldC0ke3JhbmRvbSgpfWBcbiAgICAgICAgbnVtYmVyID0gcmFuZG9tKClcbiAgICAgICAgY2l0eSA9IGBjaXR5LSR7cmFuZG9tKCl9YFxuICAgICAgICBhY2Nlc3NDb2RlID0gcmFuZG9tQWNjZXNzQ29kZShuYW1lKVxuICAgICAgICBsYXVuZHJ5TnVtID0gNFxuXG4gICAgICAgIHNpbmdsZU1lc3NhZ2UgPSBgbWVzc2FnZS0ke3JhbmRvbSgpfWBcbiAgICAgICAgZGF0ZSA9IHtcbiAgICAgICAgICAgIHN0cmluZ0RheTogXCJUdWVzZGF5XCIsXG4gICAgICAgICAgICBkYXk6IDIzLFxuICAgICAgICAgICAgbW9udGg6IFwiSnVuZVwiLFxuICAgICAgICAgICAgaG91cjogXCIxNjozNFwiXG4gICAgICAgICAgfVxuXG5cblxuICAgICAgICBoYXNoID0gYXdhaXQgYmNyeXB0Lmhhc2gocGFzc3dvcmQsIDEwKVxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5jcmVhdGUoeyBuYW1lLCBzdXJuYW1lLCBlbWFpbCwgcGFzc3dvcmQ6IGhhc2ggfSlcbiAgICAgICAgdXNlcklkID0gdXNlci5pZFxuICAgICAgICBsZXQgYWRkcmVzcyA9IHsgc3RyZWV0LCBudW1iZXIsIGNpdHkgfVxuICAgICAgICBhd2FpdCBDb2hvdXNpbmcuY3JlYXRlKHsgbmFtZTogbmFtZUNvaG91c2luZywgYWRkcmVzcywgYXV0aG9yOiB1c2VySWQsIGFjY2Vzc0NvZGUsIG1lbWJlcnM6IFt1c2VySWRdLCBsYXVuZHJ5TnVtIH0pXG5cbiAgICAgICAgXG4gICAgfSlcblxuICAgIGRlc2NyaWJlKCd3aGVuIHRoZXJlIGFyZSBzb21lIG1lc3NhZ2VzIHRvIHJldHJpZXZlJywgKCkgPT4ge1xuXG4gICAgICAgIGJlZm9yZUVhY2goIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvaG91c2luZyA9IGF3YWl0IENvaG91c2luZy5maW5kT25lKHsgbWVtYmVyczogdXNlcklkIH0pXG4gICAgICAgICAgICBjb25zdCBfbWVzc2FnZSA9IG5ldyBNZXNzYWdlKHsgdXNlcklkLCBtZXNzYWdlOiBzaW5nbGVNZXNzYWdlLCBkYXRlIH0pXG4gICAgXG4gICAgICAgICAgICBjb2hvdXNpbmcubWVzc2FnZXMucHVzaChfbWVzc2FnZSlcbiAgICAgICAgICAgIGF3YWl0IGNvaG91c2luZy5zYXZlKClcbiAgICAgICAgfSlcblxuICAgICAgICBpdCgnc2hvdWxkIHN1Y2Nlc3Mgb24gcmV0cmlldmUgbWVzc2FnZXMnLCBhc3luYyAoKSA9PiB7XG5cbiAgICAgICAgICAgIGNvbnN0IGFsbE1lc3NhZ2VzID0gYXdhaXQgcmV0cmlldmVNZXNzYWdlcyh1c2VySWQpXG4gICAgICAgICAgICBjb25zdCB7IG1lc3NhZ2VzIH0gPSBhbGxNZXNzYWdlc1xuICAgICAgICAgICAgZXhwZWN0KG1lc3NhZ2VzKS50by5leGlzdFxuICAgICAgICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLnVzZXJJZC5faWQudG9TdHJpbmcoKSkudG8uZXF1YWwodXNlcklkKVxuICAgICAgICAgICAgZXhwZWN0KG1lc3NhZ2VzWzBdLm1lc3NhZ2UpLnRvLmVxdWFsKHNpbmdsZU1lc3NhZ2UpXG4gICAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0uZGF0ZSkudG8uZXF1YWwoZGF0ZSlcblxuICAgICAgICB9KVxuICAgIH0pXG5cbiAgICBkZXNjcmliZSgnd2hlbiB0aGVyZSBhcmUgbm90IG1lc3NhZ2VzIHRvIHJldHJpZXZlJywgKCkgPT4ge1xuICAgICAgICBsZXQgYWxsTWVzc2FnZXNcbiAgICAgIFxuICAgICAgICBpdCgnc2hvdWxkIG5vdCByZXRyaWV2ZSBhbnkgbWVzc2FnZScsIGFzeW5jICgpID0+IHtcblxuICAgICAgICAgICB0cnl7XG4gICAgICAgICAgICAgICBhbGxNZXNzYWdlcyA9IGF3YWl0IHJldHJpZXZlTWVzc2FnZXModXNlcklkKVxuXG4gICAgICAgICAgIH1jYXRjaChlcnJvcil7XG4gICAgICAgICAgICAgICBleHBlY3QoZXJyb3IpLnRvLmV4aXN0XG4gICAgICAgICAgICAgICBleHBlY3QoZXJyb3IubWVzc2FnZSkudG8uZXF1YWwoJ25vIG1lc3NhZ2VzIHlldCcpXG5cbiAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pXG5cblxuICAgIGRlc2NyaWJlKCdzeW5jIGVycm9ycycsICgpID0+IHtcblxuICAgICAgICBpdCgnb24gd3JvbmcgdHlwZSBvZiBkYXRhJywgKCkgPT4ge1xuXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gcmV0cmlldmVNZXNzYWdlcyh0cnVlKSkudG8udGhyb3coVHlwZUVycm9yLCAndHJ1ZSBpcyBub3QgYSBzdHJpbmcnKVxuICAgICAgICAgICAgZXhwZWN0KCgpID0+IHJldHJpZXZlTWVzc2FnZXModW5kZWZpbmVkKSkudG8udGhyb3coVHlwZUVycm9yLCAndW5kZWZpbmVkIGlzIG5vdCBhIHN0cmluZycpXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gcmV0cmlldmVNZXNzYWdlcygyKSkudG8udGhyb3coVHlwZUVycm9yLCAnMiBpcyBub3QgYSBzdHJpbmcnKVxuICAgICAgICB9KVxuICAgIH0pXG5cblxuXG5cblxuICAgIGFmdGVyRWFjaCgoKSA9PiBVc2VyLmRlbGV0ZU1hbnkoKSlcblxuICAgIGFmdGVyKG1vbmdvb3NlLmRpc2Nvbm5lY3QpXG59KSJdfQ==