function cov_2htigvzkop(){var path="/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/retrieve-messages.spec.js";var hash="44fafe91e2e125c4f80762d3911db8f1a0f2c5b1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/retrieve-messages.spec.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:26}},"1":{start:{line:3,column:51},end:{line:3,column:58}},"2":{start:{line:5,column:19},end:{line:5,column:34}},"3":{start:{line:6,column:19},end:{line:6,column:23}},"4":{start:{line:7,column:25},end:{line:7,column:55}},"5":{start:{line:8,column:15},end:{line:8,column:34}},"6":{start:{line:9,column:40},end:{line:9,column:67}},"7":{start:{line:10,column:21},end:{line:10,column:45}},"8":{start:{line:11,column:73},end:{line:11,column:97}},"9":{start:{line:12,column:34},end:{line:12,column:61}},"10":{start:{line:16,column:0},end:{line:108,column:2}},"11":{start:{line:18,column:4},end:{line:18,column:47}},"12":{start:{line:18,column:17},end:{line:18,column:46}},"13":{start:{line:20,column:4},end:{line:50,column:6}},"14":{start:{line:22,column:8},end:{line:22,column:31}},"15":{start:{line:23,column:8},end:{line:23,column:36}},"16":{start:{line:24,column:8},end:{line:24,column:34}},"17":{start:{line:26,column:8},end:{line:26,column:33}},"18":{start:{line:27,column:8},end:{line:27,column:39}},"19":{start:{line:28,column:8},end:{line:28,column:40}},"20":{start:{line:29,column:8},end:{line:29,column:41}},"21":{start:{line:31,column:8},end:{line:31,column:42}},"22":{start:{line:32,column:8},end:{line:32,column:37}},"23":{start:{line:33,column:8},end:{line:33,column:25}},"24":{start:{line:34,column:8},end:{line:34,column:33}},"25":{start:{line:35,column:8},end:{line:35,column:43}},"26":{start:{line:36,column:8},end:{line:36,column:22}},"27":{start:{line:38,column:8},end:{line:38,column:45}},"28":{start:{line:39,column:8},end:{line:39,column:36}},"29":{start:{line:43,column:8},end:{line:43,column:46}},"30":{start:{line:44,column:21},end:{line:44,column:80}},"31":{start:{line:45,column:8},end:{line:45,column:24}},"32":{start:{line:46,column:22},end:{line:46,column:46}},"33":{start:{line:47,column:8},end:{line:47,column:123}},"34":{start:{line:52,column:4},end:{line:72,column:6}},"35":{start:{line:54,column:8},end:{line:60,column:10}},"36":{start:{line:55,column:30},end:{line:55,column:74}},"37":{start:{line:56,column:29},end:{line:56,column:82}},"38":{start:{line:58,column:12},end:{line:58,column:45}},"39":{start:{line:59,column:12},end:{line:59,column:34}},"40":{start:{line:62,column:8},end:{line:71,column:10}},"41":{start:{line:64,column:32},end:{line:64,column:62}},"42":{start:{line:65,column:33},end:{line:65,column:44}},"43":{start:{line:66,column:12},end:{line:66,column:37}},"44":{start:{line:67,column:12},end:{line:67,column:70}},"45":{start:{line:68,column:12},end:{line:68,column:63}},"46":{start:{line:69,column:12},end:{line:69,column:51}},"47":{start:{line:74,column:4},end:{line:88,column:6}},"48":{start:{line:77,column:8},end:{line:87,column:10}},"49":{start:{line:79,column:11},end:{line:86,column:12}},"50":{start:{line:80,column:15},end:{line:80,column:59}},"51":{start:{line:83,column:15},end:{line:83,column:37}},"52":{start:{line:84,column:15},end:{line:84,column:64}},"53":{start:{line:91,column:4},end:{line:99,column:6}},"54":{start:{line:93,column:8},end:{line:98,column:10}},"55":{start:{line:95,column:12},end:{line:95,column:92}},"56":{start:{line:95,column:25},end:{line:95,column:47}},"57":{start:{line:96,column:12},end:{line:96,column:102}},"58":{start:{line:96,column:25},end:{line:96,column:52}},"59":{start:{line:97,column:12},end:{line:97,column:86}},"60":{start:{line:97,column:25},end:{line:97,column:44}},"61":{start:{line:105,column:4},end:{line:105,column:38}},"62":{start:{line:105,column:20},end:{line:105,column:37}},"63":{start:{line:107,column:4},end:{line:107,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:38},end:{line:16,column:39}},loc:{start:{line:16,column:44},end:{line:108,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:18,column:11},end:{line:18,column:12}},loc:{start:{line:18,column:17},end:{line:18,column:46}},line:18},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:15},end:{line:20,column:16}},loc:{start:{line:20,column:27},end:{line:50,column:5}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:52,column:57},end:{line:52,column:58}},loc:{start:{line:52,column:63},end:{line:72,column:5}},line:52},"4":{name:"(anonymous_4)",decl:{start:{line:54,column:20},end:{line:54,column:21}},loc:{start:{line:54,column:32},end:{line:60,column:9}},line:54},"5":{name:"(anonymous_5)",decl:{start:{line:62,column:50},end:{line:62,column:51}},loc:{start:{line:62,column:62},end:{line:71,column:9}},line:62},"6":{name:"(anonymous_6)",decl:{start:{line:74,column:56},end:{line:74,column:57}},loc:{start:{line:74,column:62},end:{line:88,column:5}},line:74},"7":{name:"(anonymous_7)",decl:{start:{line:77,column:46},end:{line:77,column:47}},loc:{start:{line:77,column:58},end:{line:87,column:9}},line:77},"8":{name:"(anonymous_8)",decl:{start:{line:91,column:28},end:{line:91,column:29}},loc:{start:{line:91,column:34},end:{line:99,column:5}},line:91},"9":{name:"(anonymous_9)",decl:{start:{line:93,column:36},end:{line:93,column:37}},loc:{start:{line:93,column:42},end:{line:98,column:9}},line:93},"10":{name:"(anonymous_10)",decl:{start:{line:95,column:19},end:{line:95,column:20}},loc:{start:{line:95,column:25},end:{line:95,column:47}},line:95},"11":{name:"(anonymous_11)",decl:{start:{line:96,column:19},end:{line:96,column:20}},loc:{start:{line:96,column:25},end:{line:96,column:52}},line:96},"12":{name:"(anonymous_12)",decl:{start:{line:97,column:19},end:{line:97,column:20}},loc:{start:{line:97,column:25},end:{line:97,column:44}},line:97},"13":{name:"(anonymous_13)",decl:{start:{line:105,column:14},end:{line:105,column:15}},loc:{start:{line:105,column:20},end:{line:105,column:37}},line:105}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"44fafe91e2e125c4f80762d3911db8f1a0f2c5b1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2htigvzkop=function(){return actualCoverage;};}return actualCoverage;}cov_2htigvzkop();cov_2htigvzkop().s[0]++;require('dotenv').config();const{env:{TEST_MONGODB_URL:MONGODB_URL}}=(cov_2htigvzkop().s[1]++,process);const{expect}=(cov_2htigvzkop().s[2]++,require('chai'));const{random}=(cov_2htigvzkop().s[3]++,Math);const retrieveMessages=(cov_2htigvzkop().s[4]++,require('./retrieve-messages'));const bcrypt=(cov_2htigvzkop().s[5]++,require('bcryptjs'));const{utils:{randomAccessCode}}=(cov_2htigvzkop().s[6]++,require('coohappy-commons'));const{mongoose}=(cov_2htigvzkop().s[7]++,require('coohappy-data'));const{mongoose:{ObjectId},models:{User,Cohousing,Message}}=(cov_2htigvzkop().s[8]++,require('coohappy-data'));const{errors:{VoidError}}=(cov_2htigvzkop().s[9]++,require('coohappy-commons'));let name,surname,email,password,hash,userId,nameCohousing,street,number,city,accessCode,message,date,laundryNum;cov_2htigvzkop().s[10]++;describe('logic - retrieve-messages',()=>{cov_2htigvzkop().f[0]++;cov_2htigvzkop().s[11]++;before(()=>{cov_2htigvzkop().f[1]++;cov_2htigvzkop().s[12]++;return mongoose.connect(MONGODB_URL);});cov_2htigvzkop().s[13]++;beforeEach(async()=>{cov_2htigvzkop().f[2]++;cov_2htigvzkop().s[14]++;await User.deleteMany();cov_2htigvzkop().s[15]++;await Cohousing.deleteMany();cov_2htigvzkop().s[16]++;await Message.deleteMany();cov_2htigvzkop().s[17]++;name=`name-${random()}`;cov_2htigvzkop().s[18]++;surname=`surname-${random()}`;cov_2htigvzkop().s[19]++;email=`e-${random()}@mail.com`;cov_2htigvzkop().s[20]++;password=`password-${random()}`;cov_2htigvzkop().s[21]++;nameCohousing=`name-${random()}`;cov_2htigvzkop().s[22]++;street=`street-${random()}`;cov_2htigvzkop().s[23]++;number=random();cov_2htigvzkop().s[24]++;city=`city-${random()}`;cov_2htigvzkop().s[25]++;accessCode=randomAccessCode(name);cov_2htigvzkop().s[26]++;laundryNum=4;cov_2htigvzkop().s[27]++;singleMessage=`message-${random()}`;cov_2htigvzkop().s[28]++;date=new Date().toString();cov_2htigvzkop().s[29]++;hash=await bcrypt.hash(password,10);const user=(cov_2htigvzkop().s[30]++,await User.create({name,surname,email,password:hash}));cov_2htigvzkop().s[31]++;userId=user.id;let address=(cov_2htigvzkop().s[32]++,{street,number,city});cov_2htigvzkop().s[33]++;await Cohousing.create({name:nameCohousing,address,author:userId,accessCode,members:[userId],laundryNum});});cov_2htigvzkop().s[34]++;describe('when there are some messages to retrieve',()=>{cov_2htigvzkop().f[3]++;cov_2htigvzkop().s[35]++;beforeEach(async()=>{cov_2htigvzkop().f[4]++;const cohousing=(cov_2htigvzkop().s[36]++,await Cohousing.findOne({members:userId}));const _message=(cov_2htigvzkop().s[37]++,new Message({userId,message:singleMessage,date}));cov_2htigvzkop().s[38]++;cohousing.messages.push(_message);cov_2htigvzkop().s[39]++;await cohousing.save();});cov_2htigvzkop().s[40]++;it('should success on retrieve messages',async()=>{cov_2htigvzkop().f[5]++;const allMessages=(cov_2htigvzkop().s[41]++,await retrieveMessages(userId));const{messages}=(cov_2htigvzkop().s[42]++,allMessages);cov_2htigvzkop().s[43]++;expect(messages).to.exist;cov_2htigvzkop().s[44]++;expect(messages[0].userId._id.toString()).to.equal(userId);cov_2htigvzkop().s[45]++;expect(messages[0].message).to.equal(singleMessage);cov_2htigvzkop().s[46]++;expect(messages[0].date).to.equal(date);});});cov_2htigvzkop().s[47]++;describe('when there are not messages to retrieve',()=>{cov_2htigvzkop().f[6]++;let allMessages;cov_2htigvzkop().s[48]++;it('should not retrieve any message',async()=>{cov_2htigvzkop().f[7]++;cov_2htigvzkop().s[49]++;try{cov_2htigvzkop().s[50]++;allMessages=await retrieveMessages(userId);}catch(error){cov_2htigvzkop().s[51]++;expect(error).to.exist;cov_2htigvzkop().s[52]++;expect(error.message).to.equal('no messages yet');}});});cov_2htigvzkop().s[53]++;describe('sync errors',()=>{cov_2htigvzkop().f[8]++;cov_2htigvzkop().s[54]++;it('on wrong type of data',()=>{cov_2htigvzkop().f[9]++;cov_2htigvzkop().s[55]++;expect(()=>{cov_2htigvzkop().f[10]++;cov_2htigvzkop().s[56]++;return retrieveMessages(true);}).to.throw(TypeError,'true is not a string');cov_2htigvzkop().s[57]++;expect(()=>{cov_2htigvzkop().f[11]++;cov_2htigvzkop().s[58]++;return retrieveMessages(undefined);}).to.throw(TypeError,'undefined is not a string');cov_2htigvzkop().s[59]++;expect(()=>{cov_2htigvzkop().f[12]++;cov_2htigvzkop().s[60]++;return retrieveMessages(2);}).to.throw(TypeError,'2 is not a string');});});cov_2htigvzkop().s[61]++;afterEach(()=>{cov_2htigvzkop().f[13]++;cov_2htigvzkop().s[62]++;return User.deleteMany();});cov_2htigvzkop().s[63]++;after(mongoose.disconnect);});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJldHJpZXZlLW1lc3NhZ2VzLnNwZWMuanMiXSwibmFtZXMiOlsicmVxdWlyZSIsImNvbmZpZyIsImVudiIsIlRFU1RfTU9OR09EQl9VUkwiLCJNT05HT0RCX1VSTCIsInByb2Nlc3MiLCJleHBlY3QiLCJyYW5kb20iLCJNYXRoIiwicmV0cmlldmVNZXNzYWdlcyIsImJjcnlwdCIsInV0aWxzIiwicmFuZG9tQWNjZXNzQ29kZSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJtb2RlbHMiLCJVc2VyIiwiQ29ob3VzaW5nIiwiTWVzc2FnZSIsImVycm9ycyIsIlZvaWRFcnJvciIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwYXNzd29yZCIsImhhc2giLCJ1c2VySWQiLCJuYW1lQ29ob3VzaW5nIiwic3RyZWV0IiwibnVtYmVyIiwiY2l0eSIsImFjY2Vzc0NvZGUiLCJtZXNzYWdlIiwiZGF0ZSIsImxhdW5kcnlOdW0iLCJkZXNjcmliZSIsImJlZm9yZSIsImNvbm5lY3QiLCJiZWZvcmVFYWNoIiwiZGVsZXRlTWFueSIsInNpbmdsZU1lc3NhZ2UiLCJEYXRlIiwidG9TdHJpbmciLCJ1c2VyIiwiY3JlYXRlIiwiaWQiLCJhZGRyZXNzIiwiYXV0aG9yIiwibWVtYmVycyIsImNvaG91c2luZyIsImZpbmRPbmUiLCJfbWVzc2FnZSIsIm1lc3NhZ2VzIiwicHVzaCIsInNhdmUiLCJpdCIsImFsbE1lc3NhZ2VzIiwidG8iLCJleGlzdCIsIl9pZCIsImVxdWFsIiwiZXJyb3IiLCJ0aHJvdyIsIlR5cGVFcnJvciIsInVuZGVmaW5lZCIsImFmdGVyRWFjaCIsImFmdGVyIiwiZGlzY29ubmVjdCJdLCJtYXBwaW5ncyI6IjR4TkFlWTttSEFmWkEsT0FBTyxDQUFDLFFBQUQsQ0FBUCxDQUFrQkMsTUFBbEIsR0FFQSxLQUFNLENBQUVDLEdBQUcsQ0FBRSxDQUFFQyxnQkFBZ0IsQ0FBRUMsV0FBcEIsQ0FBUCwyQkFBNkNDLE9BQTdDLENBQU4sQ0FFQSxLQUFNLENBQUVDLE1BQUYs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LGdCQUFnQixDQUFDLElBQUQsQ0FBaEIsQ0FBc0IsQ0FBN0IsQ0FBTixDQUFxQ2dELEVBQXJDLENBQXdDSyxLQUF4QyxDQUE4Q0MsU0FBOUMsQ0FBeUQsc0JBQXpELEVBRjhCLHlCQUc5QnpELE1BQU0sQ0FBQyxJQUFNLHlEQUFBRyxDQUFBQSxnQkFBZ0IsQ0FBQ3VELFNBQUQsQ0FBaEIsQ0FBMkIsQ0FBbEMsQ0FBTixDQUEwQ1AsRUFBMUMsQ0FBNkNLLEtBQTdDLENBQW1EQyxTQUFuRCxDQUE4RCwyQkFBOUQsRUFIOEIseUJBSTlCekQsTUFBTSxDQUFDLElBQU0seURBQUFHLENBQUFBLGdCQUFnQixDQUFDLENBQUQsQ0FBaEIsQ0FBbUIsQ0FBMUIsQ0FBTixDQUFrQ2dELEVBQWxDLENBQXFDSyxLQUFyQyxDQUEyQ0MsU0FBM0MsQ0FBc0QsbUJBQXRELEVBQ0gsQ0FMQyxDQUFGLENBTUgsQ0FSTyxDQUFSLENBM0V3Qyx5QkF5RnhDRSxTQUFTLENBQUMsSUFBTSx5REFBQWpELENBQUFBLElBQUksQ0FBQ3VCLFVBQUwsR0FBaUIsQ0FBeEIsQ0FBVCxDQXpGd0MseUJBMkZ4QzJCLEtBQUssQ0FBQ3JELFFBQVEsQ0FBQ3NELFVBQVYsQ0FBTCxDQUNILENBNUZPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKVxuXG5jb25zdCB7IGVudjogeyBURVNUX01PTkdPREJfVVJMOiBNT05HT0RCX1VSTCB9IH0gPSBwcm9jZXNzXG5cbmNvbnN0IHsgZXhwZWN0IH0gPSByZXF1aXJlKCdjaGFpJylcbmNvbnN0IHsgcmFuZG9tIH0gPSBNYXRoXG5jb25zdCByZXRyaWV2ZU1lc3NhZ2VzID0gcmVxdWlyZSgnLi9yZXRyaWV2ZS1tZXNzYWdlcycpXG5jb25zdCBiY3J5cHQgPSByZXF1aXJlKCdiY3J5cHRqcycpXG5jb25zdCB7IHV0aWxzOiB7IHJhbmRvbUFjY2Vzc0NvZGUgfSB9ID0gcmVxdWlyZSgnY29vaGFwcHktY29tbW9ucycpXG5jb25zdCB7IG1vbmdvb3NlIH0gPSByZXF1aXJlKCdjb29oYXBweS1kYXRhJylcbmNvbnN0IHsgbW9uZ29vc2U6IHsgT2JqZWN0SWQgfSwgbW9kZWxzOiB7IFVzZXIsIENvaG91c2luZywgTWVzc2FnZSB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1kYXRhJylcbmNvbnN0IHsgZXJyb3JzOiB7IFZvaWRFcnJvciB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1jb21tb25zJylcblxubGV0IG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZCwgaGFzaCwgdXNlcklkLCBuYW1lQ29ob3VzaW5nLCBzdHJlZXQsIG51bWJlciwgY2l0eSwgYWNjZXNzQ29kZSwgbWVzc2FnZSwgZGF0ZSwgbGF1bmRyeU51bVxuXG5kZXNjcmliZSgnbG9naWMgLSByZXRyaWV2ZS1tZXNzYWdlcycsICgpID0+IHtcblxuICAgIGJlZm9yZSgoKSA9PiBtb25nb29zZS5jb25uZWN0KE1PTkdPREJfVVJMKSlcblxuICAgIGJlZm9yZUVhY2goYXN5bmMgKCkgPT4ge1xuXG4gICAgICAgIGF3YWl0IFVzZXIuZGVsZXRlTWFueSgpXG4gICAgICAgIGF3YWl0IENvaG91c2luZy5kZWxldGVNYW55KClcbiAgICAgICAgYXdhaXQgTWVzc2FnZS5kZWxldGVNYW55KClcblxuICAgICAgICBuYW1lID0gYG5hbWUtJHtyYW5kb20oKX1gXG4gICAgICAgIHN1cm5hbWUgPSBgc3VybmFtZS0ke3JhbmRvbSgpfWBcbiAgICAgICAgZW1haWwgPSBgZS0ke3JhbmRvbSgpfUBtYWlsLmNvbWBcbiAgICAgICAgcGFzc3dvcmQgPSBgcGFzc3dvcmQtJHtyYW5kb20oKX1gXG5cbiAgICAgICAgbmFtZUNvaG91c2luZyA9IGBuYW1lLSR7cmFuZG9tKCl9YFxuICAgICAgICBzdHJlZXQgPSBgc3RyZWV0LSR7cmFuZG9tKCl9YFxuICAgICAgICBudW1iZXIgPSByYW5kb20oKVxuICAgICAgICBjaXR5ID0gYGNpdHktJHtyYW5kb20oKX1gXG4gICAgICAgIGFjY2Vzc0NvZGUgPSByYW5kb21BY2Nlc3NDb2RlKG5hbWUpXG4gICAgICAgIGxhdW5kcnlOdW0gPSA0XG5cbiAgICAgICAgc2luZ2xlTWVzc2FnZSA9IGBtZXNzYWdlLSR7cmFuZG9tKCl9YFxuICAgICAgICBkYXRlID0gKG5ldyBEYXRlKS50b1N0cmluZygpXG5cblxuXG4gICAgICAgIGhhc2ggPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTApXG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyLmNyZWF0ZSh7IG5hbWUsIHN1cm5hbWUsIGVtYWlsLCBwYXNzd29yZDogaGFzaCB9KVxuICAgICAgICB1c2VySWQgPSB1c2VyLmlkXG4gICAgICAgIGxldCBhZGRyZXNzID0geyBzdHJlZXQsIG51bWJlciwgY2l0eSB9XG4gICAgICAgIGF3YWl0IENvaG91c2luZy5jcmVhdGUoeyBuYW1lOiBuYW1lQ29ob3VzaW5nLCBhZGRyZXNzLCBhdXRob3I6IHVzZXJJZCwgYWNjZXNzQ29kZSwgbWVtYmVyczogW3VzZXJJZF0sIGxhdW5kcnlOdW0gfSlcblxuICAgICAgICBcbiAgICB9KVxuXG4gICAgZGVzY3JpYmUoJ3doZW4gdGhlcmUgYXJlIHNvbWUgbWVzc2FnZXMgdG8gcmV0cmlldmUnLCAoKSA9PiB7XG5cbiAgICAgICAgYmVmb3JlRWFjaCggYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgY29ob3VzaW5nID0gYXdhaXQgQ29ob3VzaW5nLmZpbmRPbmUoeyBtZW1iZXJzOiB1c2VySWQgfSlcbiAgICAgICAgICAgIGNvbnN0IF9tZXNzYWdlID0gbmV3IE1lc3NhZ2UoeyB1c2VySWQsIG1lc3NhZ2U6IHNpbmdsZU1lc3NhZ2UsIGRhdGUgfSlcbiAgICBcbiAgICAgICAgICAgIGNvaG91c2luZy5tZXNzYWdlcy5wdXNoKF9tZXNzYWdlKVxuICAgICAgICAgICAgYXdhaXQgY29ob3VzaW5nLnNhdmUoKVxuICAgICAgICB9KVxuXG4gICAgICAgIGl0KCdzaG91bGQgc3VjY2VzcyBvbiByZXRyaWV2ZSBtZXNzYWdlcycsIGFzeW5jICgpID0+IHtcblxuICAgICAgICAgICAgY29uc3QgYWxsTWVzc2FnZXMgPSBhd2FpdCByZXRyaWV2ZU1lc3NhZ2VzKHVzZXJJZClcbiAgICAgICAgICAgIGNvbnN0IHsgbWVzc2FnZXMgfSA9IGFsbE1lc3NhZ2VzXG4gICAgICAgICAgICBleHBlY3QobWVzc2FnZXMpLnRvLmV4aXN0XG4gICAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0udXNlcklkLl9pZC50b1N0cmluZygpKS50by5lcXVhbCh1c2VySWQpXG4gICAgICAgICAgICBleHBlY3QobWVzc2FnZXNbMF0ubWVzc2FnZSkudG8uZXF1YWwoc2luZ2xlTWVzc2FnZSlcbiAgICAgICAgICAgIGV4cGVjdChtZXNzYWdlc1swXS5kYXRlKS50by5lcXVhbChkYXRlKVxuXG4gICAgICAgIH0pXG4gICAgfSlcblxuICAgIGRlc2NyaWJlKCd3aGVuIHRoZXJlIGFyZSBub3QgbWVzc2FnZXMgdG8gcmV0cmlldmUnLCAoKSA9PiB7XG4gICAgICAgIGxldCBhbGxNZXNzYWdlc1xuICAgICAgXG4gICAgICAgIGl0KCdzaG91bGQgbm90IHJldHJpZXZlIGFueSBtZXNzYWdlJywgYXN5bmMgKCkgPT4ge1xuXG4gICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgIGFsbE1lc3NhZ2VzID0gYXdhaXQgcmV0cmlldmVNZXNzYWdlcyh1c2VySWQpXG5cbiAgICAgICAgICAgfWNhdGNoKGVycm9yKXtcbiAgICAgICAgICAgICAgIGV4cGVjdChlcnJvcikudG8uZXhpc3RcbiAgICAgICAgICAgICAgIGV4cGVjdChlcnJvci5tZXNzYWdlKS50by5lcXVhbCgnbm8gbWVzc2FnZXMgeWV0JylcblxuICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfSlcblxuXG4gICAgZGVzY3JpYmUoJ3N5bmMgZXJyb3JzJywgKCkgPT4ge1xuXG4gICAgICAgIGl0KCdvbiB3cm9uZyB0eXBlIG9mIGRhdGEnLCAoKSA9PiB7XG5cbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiByZXRyaWV2ZU1lc3NhZ2VzKHRydWUpKS50by50aHJvdyhUeXBlRXJyb3IsICd0cnVlIGlzIG5vdCBhIHN0cmluZycpXG4gICAgICAgICAgICBleHBlY3QoKCkgPT4gcmV0cmlldmVNZXNzYWdlcyh1bmRlZmluZWQpKS50by50aHJvdyhUeXBlRXJyb3IsICd1bmRlZmluZWQgaXMgbm90IGEgc3RyaW5nJylcbiAgICAgICAgICAgIGV4cGVjdCgoKSA9PiByZXRyaWV2ZU1lc3NhZ2VzKDIpKS50by50aHJvdyhUeXBlRXJyb3IsICcyIGlzIG5vdCBhIHN0cmluZycpXG4gICAgICAgIH0pXG4gICAgfSlcblxuXG5cblxuXG4gICAgYWZ0ZXJFYWNoKCgpID0+IFVzZXIuZGVsZXRlTWFueSgpKVxuXG4gICAgYWZ0ZXIobW9uZ29vc2UuZGlzY29ubmVjdClcbn0pIl19