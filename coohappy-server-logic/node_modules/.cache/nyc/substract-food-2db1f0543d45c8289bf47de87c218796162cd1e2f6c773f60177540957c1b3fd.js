function cov_2mer7aa24i(){var path="/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/substract-food.js";var hash="5068de3f5f8f9c0b4578b614f8867f040474c6fd";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mac/bootcamp/collab/skylab-bootcamp-202004/staff/sergi-ramos/coohappy/coohappy-server-logic/substract-food.js",statementMap:{"0":{start:{line:1,column:0},end:{line:1,column:44}},"1":{start:{line:2,column:0},end:{line:2,column:42}},"2":{start:{line:3,column:41},end:{line:3,column:68}},"3":{start:{line:4,column:40},end:{line:4,column:64}},"4":{start:{line:5,column:35},end:{line:5,column:59}},"5":{start:{line:8,column:0},end:{line:53,column:1}},"6":{start:{line:10,column:4},end:{line:10,column:37}},"7":{start:{line:11,column:4},end:{line:11,column:35}},"8":{start:{line:13,column:4},end:{line:52,column:8}},"9":{start:{line:15,column:21},end:{line:15,column:48}},"10":{start:{line:16,column:8},end:{line:16,column:86}},"11":{start:{line:16,column:19},end:{line:16,column:86}},"12":{start:{line:18,column:26},end:{line:18,column:82}},"13":{start:{line:19,column:8},end:{line:19,column:108}},"14":{start:{line:19,column:24},end:{line:19,column:108}},"15":{start:{line:21,column:27},end:{line:21,column:59}},"16":{start:{line:21,column:36},end:{line:21,column:59}},"17":{start:{line:23,column:8},end:{line:34,column:115}},"18":{start:{line:25,column:12},end:{line:33,column:13}},"19":{start:{line:27,column:16},end:{line:32,column:17}},"20":{start:{line:28,column:20},end:{line:31,column:88}},"21":{start:{line:29,column:24},end:{line:29,column:53}},"22":{start:{line:31,column:25},end:{line:31,column:88}},"23":{start:{line:34,column:15},end:{line:34,column:115}},"24":{start:{line:36,column:9},end:{line:47,column:115}},"25":{start:{line:38,column:12},end:{line:46,column:13}},"26":{start:{line:40,column:16},end:{line:45,column:17}},"27":{start:{line:41,column:20},end:{line:44,column:98}},"28":{start:{line:42,column:24},end:{line:42,column:58}},"29":{start:{line:44,column:25},end:{line:44,column:98}},"30":{start:{line:47,column:15},end:{line:47,column:115}},"31":{start:{line:49,column:8},end:{line:49,column:25}},"32":{start:{line:50,column:8},end:{line:50,column:30}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:8,column:17},end:{line:8,column:18}},loc:{start:{line:8,column:39},end:{line:53,column:1}},line:8},"1":{name:"(anonymous_1)",decl:{start:{line:13,column:12},end:{line:13,column:13}},loc:{start:{line:13,column:24},end:{line:52,column:5}},line:13},"2":{name:"(anonymous_2)",decl:{start:{line:21,column:27},end:{line:21,column:28}},loc:{start:{line:21,column:36},end:{line:21,column:59}},line:21}},branchMap:{"0":{loc:{start:{line:16,column:8},end:{line:16,column:86}},type:"if",locations:[{start:{line:16,column:8},end:{line:16,column:86}},{start:{line:16,column:8},end:{line:16,column:86}}],line:16},"1":{loc:{start:{line:19,column:8},end:{line:19,column:108}},type:"if",locations:[{start:{line:19,column:8},end:{line:19,column:108}},{start:{line:19,column:8},end:{line:19,column:108}}],line:19},"2":{loc:{start:{line:23,column:8},end:{line:34,column:115}},type:"if",locations:[{start:{line:23,column:8},end:{line:34,column:115}},{start:{line:23,column:8},end:{line:34,column:115}}],line:23},"3":{loc:{start:{line:27,column:16},end:{line:32,column:17}},type:"if",locations:[{start:{line:27,column:16},end:{line:32,column:17}},{start:{line:27,column:16},end:{line:32,column:17}}],line:27},"4":{loc:{start:{line:28,column:20},end:{line:31,column:88}},type:"if",locations:[{start:{line:28,column:20},end:{line:31,column:88}},{start:{line:28,column:20},end:{line:31,column:88}}],line:28},"5":{loc:{start:{line:36,column:9},end:{line:47,column:115}},type:"if",locations:[{start:{line:36,column:9},end:{line:47,column:115}},{start:{line:36,column:9},end:{line:47,column:115}}],line:36},"6":{loc:{start:{line:40,column:16},end:{line:45,column:17}},type:"if",locations:[{start:{line:40,column:16},end:{line:45,column:17}},{start:{line:40,column:16},end:{line:45,column:17}}],line:40},"7":{loc:{start:{line:41,column:20},end:{line:44,column:98}},type:"if",locations:[{start:{line:41,column:20},end:{line:44,column:98}},{start:{line:41,column:20},end:{line:44,column:98}}],line:41}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"5068de3f5f8f9c0b4578b614f8867f040474c6fd"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2mer7aa24i=function(){return actualCoverage;};}return actualCoverage;}cov_2mer7aa24i();cov_2mer7aa24i().s[0]++;require('coohappy-commons/polyfills/string');cov_2mer7aa24i().s[1]++;require('coohappy-commons/polyfills/json');const{errors:{UnexistenceError}}=(cov_2mer7aa24i().s[2]++,require('coohappy-commons'));const{models:{User,Cohousing}}=(cov_2mer7aa24i().s[3]++,require('coohappy-data'));const{mongoose:{ObjectId}}=(cov_2mer7aa24i().s[4]++,require('coohappy-data'));cov_2mer7aa24i().s[5]++;module.exports=(foodItem,userId)=>{cov_2mer7aa24i().f[0]++;cov_2mer7aa24i().s[6]++;String.validate.notVoid(foodItem);cov_2mer7aa24i().s[7]++;String.validate.notVoid(userId);cov_2mer7aa24i().s[8]++;return(async()=>{cov_2mer7aa24i().f[1]++;const user=(cov_2mer7aa24i().s[9]++,await User.findById(userId));cov_2mer7aa24i().s[10]++;if(!user){cov_2mer7aa24i().b[0][0]++;cov_2mer7aa24i().s[11]++;throw new UnexistenceError(`User with id ${userId} does not exist`);}else{cov_2mer7aa24i().b[0][1]++;}const cohousing=(cov_2mer7aa24i().s[12]++,await Cohousing.findOne({'members':ObjectId(userId)}));cov_2mer7aa24i().s[13]++;if(!cohousing){cov_2mer7aa24i().b[1][0]++;cov_2mer7aa24i().s[14]++;throw new UnexistenceError(`There is no cohousing with a user with an id ${userId}`);}else{cov_2mer7aa24i().b[1][1]++;}cov_2mer7aa24i().s[15]++;const checkFruit=fruit=>{cov_2mer7aa24i().f[2]++;cov_2mer7aa24i().s[16]++;return fruit.name===foodItem;};cov_2mer7aa24i().s[17]++;if(user.foodList.some(checkFruit)){cov_2mer7aa24i().b[2][0]++;cov_2mer7aa24i().s[18]++;for(index in user.foodList){cov_2mer7aa24i().s[19]++;if(foodItem===user.foodList[index].name){cov_2mer7aa24i().b[3][0]++;cov_2mer7aa24i().s[20]++;if(user.foodList[index].weight===0.5){cov_2mer7aa24i().b[4][0]++;cov_2mer7aa24i().s[21]++;user.foodList.splice(index,1);}else{cov_2mer7aa24i().b[4][1]++;cov_2mer7aa24i().s[22]++;user.foodList[index].weight=user.foodList[index].weight-0.5;}}else{cov_2mer7aa24i().b[3][1]++;}}}else{cov_2mer7aa24i().b[2][1]++;cov_2mer7aa24i().s[23]++;throw new UnexistenceError(`you can not substract ${foodItem}, you still don't have it on the list`);}cov_2mer7aa24i().s[24]++;if(cohousing.foodList.some(checkFruit)){cov_2mer7aa24i().b[5][0]++;cov_2mer7aa24i().s[25]++;for(index in cohousing.foodList){cov_2mer7aa24i().s[26]++;if(foodItem===cohousing.foodList[index].name){cov_2mer7aa24i().b[6][0]++;cov_2mer7aa24i().s[27]++;if(cohousing.foodList[index].weight===0.5){cov_2mer7aa24i().b[7][0]++;cov_2mer7aa24i().s[28]++;cohousing.foodList.splice(index,1);}else{cov_2mer7aa24i().b[7][1]++;cov_2mer7aa24i().s[29]++;cohousing.foodList[index].weight=cohousing.foodList[index].weight-0.5;}}else{cov_2mer7aa24i().b[6][1]++;}}}else{cov_2mer7aa24i().b[5][1]++;cov_2mer7aa24i().s[30]++;throw new UnexistenceError(`you can not substract ${foodItem}, you still don't have it on the list`);}cov_2mer7aa24i().s[31]++;await user.save();cov_2mer7aa24i().s[32]++;await cohousing.save();})();};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInN1YnN0cmFjdC1mb29kLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJlcnJvcnMiLCJVbmV4aXN0ZW5jZUVycm9yIiwibW9kZWxzIiwiVXNlciIsIkNvaG91c2luZyIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJtb2R1bGUiLCJleHBvcnRzIiwiZm9vZEl0ZW0iLCJ1c2VySWQiLCJTdHJpbmciLCJ2YWxpZGF0ZSIsIm5vdFZvaWQiLCJ1c2VyIiwiZmluZEJ5SWQiLCJjb2hvdXNpbmciLCJmaW5kT25lIiwiY2hlY2tGcnVpdCIsImZydWl0IiwibmFtZSIsImZvb2RMaXN0Iiwic29tZSIsImluZGV4Iiwid2VpZ2h0Iiwic3BsaWNlIiwic2F2ZSJdLCJtYXBwaW5ncyI6Imd5SkFlWTttSEFmWkEsT0FBTyxDQUFDLG1DQUFELENBQVAsQyx3QkFDQUEsT0FBTyxDQUFDLGlDQUFELENBQVAsQ0FDQSxLQUFNLENBQUVDLE1BQU0sQ0FBRSxDQUFFQyxnQkFBRixDQUFWLDJCQUFtQ0YsT0FBTyxDQUFDLGtCQUFELENBQTFDLENBQU4sQ0FDQSxLQUFNLENBQUVHLE1BQU0sQ0FBRSxDQUFFQyxJQUFGLENBQVFDLFNBQVIsQ0FBViwyQkFBa0NMLE9BQU8sQ0FBQyxlQUFELENBQXpDLENBQU4sQ0FDQSxLQUFNLENBQUVNLFFBQVEsQ0FBRSxDQUFFQyxRQUFGLENBQVosMkJBQTZCUCxPQUFPLENBQUMsZUFBRCxDQUFwQyxDQUFOLEMsd0JBR0FRLE1BQU0sQ0FBQ0MsT0FBUCxDQUFpQixDQUFDQyxRQUFELENBQVdDLE1BQVgsR0FBc0IsaURBRW5DQyxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLE9BQWhCLENBQXdCSixRQUF4QixFQUZtQyx3QkFHbkNFLE1BQU0sQ0FBQ0MsUUFBUCxDQUFnQkMsT0FBaEIsQ0FBd0JILE1BQXhCLEVBSG1DLHdCQUtuQyxNQUFPLENBQUMsU0FBWSx5QkFFaEIsS0FBTUksQ0FBQUEsSUFBSSwwQkFBRyxLQUFNWCxDQUFBQSxJQUFJLENBQUNZLFFBQUwsQ0FBY0wsTUFBZCxDQUFULENBQVYsQ0FGZ0IseUJBR2hCLEdBQUksQ0FBQ0ksSUFBTCxDQUFXLDBEQUFNLElBQUliLENBQUFBLGdCQUFKLENBQXNCLGdCQUFlUyxNQUFPLGlCQUE1QyxDQUFOLENBQW1FLENBQTlFLGlDQUVBLEtBQU1NLENBQUFBLFNBQVMsMkJBQUcsS0FBTVosQ0FBQUEsU0FBUyxDQUFDYSxPQUFWLENBQWtCLENBQUUsVUFBV1gsUUFBUSxDQUFDSSxNQUFELENBQXJCLENBQWxCLENBQVQsQ0FBZixDQUxnQix5QkFNaEIsR0FBSSxDQUFDTSxTQUFMLENBQWdCLDBEQUFNLElBQUlmLENBQUFBLGdCQUFKLENBQXNCLGdEQUErQ1MsTUFBTyxFQUE1RSxDQUFOLENBQW9GLENBQXBHLGlDQU5nQix5QkFRaEIsS0FBTVEsQ0FBQUEsVUFBVSxDQUFHQyxLQUFLLEVBQUksd0RBQUFBLENBQUFBLEtBQUssQ0FBQ0MsSUFBTixHQUFlWCxRQUFmLENBQXVCLENBQW5ELENBUmdCLHlCQVVoQixHQUFHSyxJQUFJLENBQUNPLFFBQUwsQ0FBY0MsSUFBZCxDQUFtQkosVUFBbkIsQ0FBSCxDQUFrQyxxREFFOUIsSUFBS0ssS0FBTCxHQUFjVCxDQUFBQSxJQUFJLENBQUNPLFFBQW5CLENBQTZCLDBCQUV6QixHQUFJWixRQUFRLEdBQUtLLElBQUksQ0FBQ08sUUFBTCxDQUFjRSxLQUFkLEVBQXFCSCxJQUF0QyxDQUE0QyxxREFDeEMsR0FBR04sSUFBSSxDQUFDTyxRQUFMLENBQWNFLEtBQWQsRUFBcUJDLE1BQXJCLEdBQWdDLEdBQW5DLENBQXdDLHFEQUNwQ1YsSUFBSSxDQUFDTyxRQUFMLENBQWNJLE1BQWQsQ0FBcUJGLEtBQXJCLENBQTJCLENBQTNCLEVBQ0gsQ0FGRCxJQUdLLHFEQUFBVCxJQUFJLENBQUNPLFFBQUwsQ0FBY0UsS0FBZCxFQUFxQkMsTUFBckIsQ0FBOEJWLElBQUksQ0FBQ08sUUFBTCxDQUFjRSxLQUFkLEVBQXFCQyxNQUFyQixDQUE4QixHQUE1RCxDQUErRCxDQUN2RSxDQUxELGlDQU1ILENBQ0gsQ0FYRixJQVdPLDBEQUFNLElBQUl2QixDQUFBQSxnQkFBSixDQUFzQix5QkFBd0JRLFFBQVMsdUNBQXZELENBQU4sQ0FBb0csQ0FyQjNGLHlCQXVCZixHQUFHTyxTQUFTLENBQUNLLFFBQVYsQ0FBbUJDLElBQW5CLENBQXdCSixVQUF4QixDQUFILENBQXVDLHFEQUVwQyxJQUFLSyxLQUFMLEdBQWNQLENBQUFBLFNBQVMsQ0FBQ0ssUUFBeEIsQ0FBa0MsMEJBRTlCLEdBQUlaLFFBQVEsR0FBS08sU0FBUyxDQUFDSyxRQUFWLENBQW1CRSxLQUFuQixFQUEwQkgsSUFBM0MsQ0FBaUQscURBQzdDLEdBQUdKLFNBQVMsQ0FBQ0ssUUFBVixDQUFtQkUsS0FBbkIsRUFBMEJDLE1BQTFCLEdBQXFDLEdBQXhDLENBQTZDLHFEQUN6Q1IsU0FBUyxDQUFDSyxRQUFWLENBQW1CSSxNQUFuQixDQUEwQkYsS0FBMUIsQ0FBZ0MsQ0FBaEMsRUFDSCxDQUZELElBR0sscURBQUFQLFNBQVMsQ0FBQ0ssUUFBVixDQUFtQkUsS0FBbkIsRUFBMEJDLE1BQTFCLENBQW1DUixTQUFTLENBQUNLLFFBQVYsQ0FBbUJFLEtBQW5CLEVBQTBCQyxNQUExQixDQUFtQyxHQUF0RSxDQUF5RSxDQUNqRixDQUxELGlDQU1ILENBQ0gsQ0FYRCxJQVdNLDBEQUFNLElBQUl2QixDQUFBQSxnQkFBSixDQUFzQix5QkFBd0JRLFFBQVMsdUNBQXZELENBQU4sQ0FBb0csQ0FsQzNGLHlCQW9DaEIsS0FBTUssQ0FBQUEsSUFBSSxDQUFDWSxJQUFMLEVBQU4sQ0FwQ2dCLHlCQXFDaEIsS0FBTVYsQ0FBQUEsU0FBUyxDQUFDVSxJQUFWLEVBQU4sQ0FFSCxDQXZDTSxHQUFQLENBd0NILENBN0NEIiwic291cmNlc0NvbnRlbnQiOlsicmVxdWlyZSgnY29vaGFwcHktY29tbW9ucy9wb2x5ZmlsbHMvc3RyaW5nJylcbnJlcXVpcmUoJ2Nvb2hhcHB5LWNvbW1vbnMvcG9seWZpbGxzL2pzb24nKVxuY29uc3QgeyBlcnJvcnM6IHsgVW5leGlzdGVuY2VFcnJvciB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1jb21tb25zJylcbmNvbnN0IHsgbW9kZWxzOiB7IFVzZXIsIENvaG91c2luZyB9IH0gPSByZXF1aXJlKCdjb29oYXBweS1kYXRhJylcbmNvbnN0IHsgbW9uZ29vc2U6IHsgT2JqZWN0SWQgfSB9ID0gcmVxdWlyZSgnY29vaGFwcHktZGF0YScpXG5cblxubW9kdWxlLmV4cG9ydHMgPSAoZm9vZEl0ZW0sIHVzZXJJZCkgPT4ge1xuXG4gICAgU3RyaW5nLnZhbGlkYXRlLm5vdFZvaWQoZm9vZEl0ZW0pXG4gICAgU3RyaW5nLnZhbGlkYXRlLm5vdFZvaWQodXNlcklkKVxuXG4gICAgcmV0dXJuIChhc3luYyAoKSA9PiB7XG5cbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQodXNlcklkKVxuICAgICAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBVbmV4aXN0ZW5jZUVycm9yKGBVc2VyIHdpdGggaWQgJHt1c2VySWR9IGRvZXMgbm90IGV4aXN0YClcblxuICAgICAgICBjb25zdCBjb2hvdXNpbmcgPSBhd2FpdCBDb2hvdXNpbmcuZmluZE9uZSh7ICdtZW1iZXJzJzogT2JqZWN0SWQodXNlcklkKSB9KVxuICAgICAgICBpZiAoIWNvaG91c2luZykgdGhyb3cgbmV3IFVuZXhpc3RlbmNlRXJyb3IoYFRoZXJlIGlzIG5vIGNvaG91c2luZyB3aXRoIGEgdXNlciB3aXRoIGFuIGlkICR7dXNlcklkfWApXG5cbiAgICAgICAgY29uc3QgY2hlY2tGcnVpdCA9IGZydWl0ID0+IGZydWl0Lm5hbWUgPT09IGZvb2RJdGVtXG4gICAgICAgIFxuICAgICAgICBpZih1c2VyLmZvb2RMaXN0LnNvbWUoY2hlY2tGcnVpdCkpeyBcblxuICAgICAgICAgICAgZm9yIChpbmRleCBpbiB1c2VyLmZvb2RMaXN0KSB7XG4gICAgXG4gICAgICAgICAgICAgICAgaWYgKGZvb2RJdGVtID09PSB1c2VyLmZvb2RMaXN0W2luZGV4XS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKHVzZXIuZm9vZExpc3RbaW5kZXhdLndlaWdodCA9PT0gMC41KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyLmZvb2RMaXN0LnNwbGljZShpbmRleCwxKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2UgdXNlci5mb29kTGlzdFtpbmRleF0ud2VpZ2h0ID0gdXNlci5mb29kTGlzdFtpbmRleF0ud2VpZ2h0IC0gMC41XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgfWVsc2UgdGhyb3cgbmV3IFVuZXhpc3RlbmNlRXJyb3IoYHlvdSBjYW4gbm90IHN1YnN0cmFjdCAke2Zvb2RJdGVtfSwgeW91IHN0aWxsIGRvbid0IGhhdmUgaXQgb24gdGhlIGxpc3RgKVxuXG4gICAgICAgICBpZihjb2hvdXNpbmcuZm9vZExpc3Quc29tZShjaGVja0ZydWl0KSl7IFxuXG4gICAgICAgICAgICBmb3IgKGluZGV4IGluIGNvaG91c2luZy5mb29kTGlzdCkge1xuICAgIFxuICAgICAgICAgICAgICAgIGlmIChmb29kSXRlbSA9PT0gY29ob3VzaW5nLmZvb2RMaXN0W2luZGV4XS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGNvaG91c2luZy5mb29kTGlzdFtpbmRleF0ud2VpZ2h0ID09PSAwLjUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvaG91c2luZy5mb29kTGlzdC5zcGxpY2UoaW5kZXgsMSlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIGNvaG91c2luZy5mb29kTGlzdFtpbmRleF0ud2VpZ2h0ID0gY29ob3VzaW5nLmZvb2RMaXN0W2luZGV4XS53ZWlnaHQgLSAwLjVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICB9ZWxzZSB0aHJvdyBuZXcgVW5leGlzdGVuY2VFcnJvcihgeW91IGNhbiBub3Qgc3Vic3RyYWN0ICR7Zm9vZEl0ZW19LCB5b3Ugc3RpbGwgZG9uJ3QgaGF2ZSBpdCBvbiB0aGUgbGlzdGApXG4gICAgICAgICAgICAgXG4gICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpXG4gICAgICAgIGF3YWl0IGNvaG91c2luZy5zYXZlKClcblxuICAgIH0pKClcbn0iXX0=